<!DOCTYPE html>

<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <!--
        hexo-theme-suka © SukkaW
        GitHub: https://github.com/SukkaW/hexo-theme-suka
    -->

    <!-- ### Resource Hint ### -->

    <!-- ## DNS Prefetch ## -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

<!-- busuanzi -->

    <link rel="dns-prefetch" href="//busuanzi.ibruce.info">


<!-- comment -->






    <link rel="dns-prefetch" href="//cdn1.lncld.net">


<!-- analytics -->







    <!-- ## Preload ## -->
    
    <!-- Busuanzi -->
    
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" as="script">







    <!-- ### Meta & Title & Info ### -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    <meta name="renderer" content="webkit">

    <!-- Title -->
    <title>Android Display/Graphics调试技巧（六月份更新） | sunwengang blog</title>

    <!-- Favicons -->
    <link rel="icon" type="image&#x2F;ico" href="/Blog/img/favicon.ico">

    <!-- ### Import File ### -->
    <link rel="stylesheet" href="/Blog/lib/spectre/spectre.min.css"><style>
    body {
        background-color: #f8f9fa;
    }

    a, a:visited {
        color: #8E354A;
    }

    a:active, a:focus, a:hover {
        color: #8E354A;
        opacity: .75;
    }

    #post-content a,
    #post-content a:hover,
    #post-content a:focus,
    #post-content a:visited {
        color: #005eb9;
        opacity: 1;
    }

    

    .post-entry .card-body a {
        color: #8E354A;
    }

    .avatar {
        background: #444;
    }

    .navbar-link,
    .navbar-link:visited,
    .timeline .timeline-item .timeline-icon.icon-lg {
        color: #8E354A;
    }

    .navbar-link:hover {
        color: #8E354A;
        opacity: .8;
    }

    #search-input .btn,
    #disqus_click_btn,
    #disqus-switch-to-direct,
    #disqus-loadmore-button {
        background: #727e96;
        border-color: #727e96;
        color: #fff;
    }

    #post-toc a.post-toc-link,
    #post-toc a.post-toc-link:visited,
    .share-menu.menu .menu-item>a {
        color: #727e96;
    }

    .share-menu.menu .menu-item>a:hover,
    .share-menu.menu .menu-item>a:focus,
    .share-menu.menu .menu-item>a:visited {
        color: #50596c;
        background: #f8f9fa;
        opacity: .85;
    }
</style><link rel="stylesheet" href="/Blog/css/style.min.css">








    <!-- Prettify Theme -->
    
    <link rel="preload" href="/Blog/css/highlight/arduino-light.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="/Blog/css/highlight/arduino-light.min.css"></noscript>





<script>
/*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
!function(t){"use strict";t.loadCSS||(t.loadCSS=function(){});var e=loadCSS.relpreload={};if(e.support=function(){var e;try{e=t.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),e.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},e.poly=function(){if(!e.support())for(var a=t.document.getElementsByTagName("link"),n=0;n<a.length;n++){var o=a[n];"preload"!==o.rel||"style"!==o.getAttribute("as")||o.getAttribute("data-loadcss")||(o.setAttribute("data-loadcss",!0),e.bindMediaToggle(o))}},!e.support()){e.poly();var a=t.setInterval(e.poly,500);t.addEventListener?t.addEventListener("load",function(){e.poly(),t.clearInterval(a)}):t.attachEvent&&t.attachEvent("onload",function(){e.poly(),t.clearInterval(a)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:t.loadCSS=loadCSS}("undefined"!=typeof global?global:this);
</script>

    <!-- ### Site Verification ### -->
    


    <link rel="alternate" type="application/atom+xml" href="/Blog/atom.xml"><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="sunwengang blog"><meta name="msapplication-starturl" content="https://alonealive.github.io/Blog"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="sunwengang blog"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- ### The Open Graph & Twitter Card Protocol ### -->
    <meta property="og:title" content="Android Display&#x2F;Graphics调试技巧（六月份更新） | sunwengang blog"><meta property="og:site_name" content="sunwengang blog"><meta property="og:type" content="article"><meta property="og:url" content="https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/"><meta property="og:locale" content="zh-CN"><meta name="description" content="android display&#x2F;graphics相关的调试方法和优化工作效率技巧整理 - sunwengang - sunwengang blog"><meta name="keywords" content="android, graphics, display"><meta property="article:published_time" content="2021-06-07T13:52:00.000Z"><meta property="article:modified_time" content="2021-06-08T14:50:41.463Z"><meta property="og:updated_time" content="2021-06-08T14:50:41.463Z"><meta property="article:author" content="sunwengang"><meta property="article:tag" content="android, graphics, display"><meta name="twitter:card" content="summary">

    

    <!-- ### Canonical link ### -->
    <link rel="canonical" href="https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/">

    <meta name="generator" content="Hexo 4.2.0">

    <!-- ### Analytics ### -->
    







    <!-- ### Structured Data ### -->
    



<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "url": "https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/",
    "@type": "BlogPosting",
    "logo": "https://alonealive.github.io/Blog/img/favicon.ico",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/"
    },
    "headline": "Android Display/Graphics调试技巧（六月份更新） | sunwengang blog",
    
    "image": {
        "@type": "ImageObject",
        "url": "https://alonealive.github.io/Blog/img/favicon.ico"
    },
    
    "datePublished": "2021-06-07T13:52:00.000Z",
    "dateModified": "2021-06-08T14:50:41.463Z",
    "author": {
        "@type": "Person",
        "name": "sunwengang",
        "image": {
            "@type": "ImageObject",
            "url": "https://alonealive.github.io/Blog/img/head.jpg"
        },
        "description": "developer | android display/graphics"
    },
    "publisher": {
        "@type": "Organization",
        "name": "sunwengang blog",
        "logo": {
            "@type": "ImageObject",
            "url": "https://alonealive.github.io/Blog/img/favicon.ico"
        }
    },
    
    "potentialAction": {
        "@type": "SearchAction",
        "target": "https://alonealive.github.io/Blog/Blog/search?s={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    
    "keywords": "android, graphics, display",
    "description": "android display/graphics相关的调试方法和优化工作效率技巧整理 - sunwengang - sunwengang blog"
}
</script>



    <!-- ### Custom Head ### -->
    
</head>

    <body>
            

            <!-- ### Main content ### -->
            <!-- ## Header ##-->
<header>
    <h1 class="header-title text-center"><a href="/Blog/">sunwengang blog</a></h1>

    <p class="text-center header-slogan">
        
            
                developer | android display/graphics
            
        
    </p>

    <nav class="navbar-section text-center">
    
        <a href="/Blog/" class="navbar-link">首页</a>
    
    
        <a href="/Blog/archives/" class="navbar-link">归档</a>
    
    
        <a href="/Blog/search" class="navbar-link">搜索</a>
    
    
        <a href="/Blog/tags" class="navbar-link">标签</a>
    
        <a href="/Blog/html/nav.html" class="navbar-link">导航</a>
    
        <a href="/Blog/links" class="navbar-link">友链</a>
    
    
        <div class="dropdown dropdown-right">
    <a class="navbar-link dropdown-toggle" tabindex="0">分享</a>
    <ul class="menu share-menu">

        <!-- Share Weibo -->
        
        <li class="menu-item">
            <a href="http://service.weibo.com/share/share.php?appkey=&title=sunwengang blog&url=https://alonealive.github.io/Blog&pic=https://alonealive.github.io/Blog/img/favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">分享到微博</a>
        </li>
        

        <!-- Share Twitter -->
        
        <li class="menu-item">
            <a href="https://twitter.com/intent/tweet?text=sunwengang blog&url=https://alonealive.github.io/Blog&via=sunwengang" target="_blank" rel="external noopener noreferrer nofollow">分享到 Twitter</a>
        </li>
        

        <!-- Share Facebook -->
        
        <li class="menu-item">
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://alonealive.github.io/Blog" target="_blank" rel="external noopener noreferrer nofollow">分享到 Facebook</a>
        </li>
        

        <!-- Share Google+ -->
        
        <li class="menu-item">
            <a href="https://plus.google.com/share?url=https://alonealive.github.io/Blog" target="_blank" rel="external noopener noreferrer nofollow">分享到 Google+</a>
        </li>
        

        <!-- Share LinkedIn -->
        
        <li class="menu-item">
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://alonealive.github.io/Blog&title=Android Display/Graphics调试技巧（六月份更新）" target="_blank" rel="external noopener noreferrer nofollow">分享到 LinkedIn</a>
        </li>
        

        <!-- Share QQ -->
        
        <li class="menu-item">
            <a href="http://connect.qq.com/widget/shareqq/index.html?site=sunwengang blog&title=Android Display/Graphics调试技巧（六月份更新）&summary=&pics=https://alonealive.github.io/Blog/img/favicon.ico&url=https://alonealive.github.io/Blog" target="_blank" rel="external noopener noreferrer nofollow"> 分享到 QQ</a>
        </li>
        

        <!-- Share Telegram -->
        
        <li class="menu-item">
            <a href="https://t.me/share/url?url=https://alonealive.github.io/Blog&text=Android Display/Graphics调试技巧（六月份更新）" target="_blank" rel="external noopener noreferrer nofollow">分享到 Telegram</a>
        </li>
        

        <!-- QRCode -->
        
        <li class="menu-item">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKQAAACkCAAAAAA83tqdAAACP0lEQVR42u2bwY7CMAwF+/8/vXtFVeI3rkDLxpML0IZ2imLHfjbXzz8Yl5BCCinkF0BexXg9/zp/9X51rfu5au7qe0LOhVwu2htkglu93oGqOcsfQcjRkCuDSQt+Z0irh6quv72ekEJuJu+gV1B0MxBSyHcZzs7Bp+NCCtmFLDf6EJymwPfjUZCQx0GmROxTr2/NFoU8BhIJR0UylgxpZzhvV9WEPAaSOu0qsK02hp3BIBFCyJGQq8WdhKsUMOyOdY4LORcyJVQ06ao+V8fKBxNyLGRyxjtRNBkUEQnK+wg5EpIYSrXIiVNP343igJCjIFOxsirIp6SKOvGteCXkSMhuIZ4kZ6n42Rb2hRwJmRxrClC74gASG4QcC0kKlKlI2jG0NF/I2ZBPGjOTgVGBNRqdkEICkapThH9UiO9WaYU8DpIkWCSJos0hjxpFhBwLSRuDq2SrcuqdJighZ0OmAKDjxBNgR1QVciZkEpc6hpKK+KSw3+5mEfJoSCrIJzGBCF7tTlQhx0CSmxERFDln0JAnpJDVDaukK51PSRspogo5G7KTvJNGpSeF+Wg4Qo6BTCI9cfrRCC7+B2AhhSTBbLc4SgrycQMQciRkGslQyGZAG0ajiCrkCEgiJlGhiQQdSUxoV2mFPBKSGEz1UAmCCAbLewk5GjI1d+wWeBXMEgMUUsgnkLSI3ikGkEBDSCFTgT0ZCRFdiYEJKSRtDukK9enBUgFKyLmQXSGJBrnEAKsfR8iZkN88hBRSSCH/cPwCtFt15DvExR8AAAAASUVORK5CYII=" alr="QRCode">
        </li>
        

    </ul>
</div>
    
    
</nav>
</header>

            
    <!-- ## Post ## -->
    <div class="post-container">
    <div id="post-card" class="card">
        
        <div class="card-item-container">
            <div class="card-inner-cell">
                <!-- # Post Header Info # -->
                <div class="card-header">
                    
    <h1 class="card-title h3 mb-2">Android Display/Graphics调试技巧（六月份更新）</h1>




<div class="post-header-info">
    <p class="post-header-info-left text-gray">
        <img class="author-thumb lazyload" data-src="/Blog/img/head.jpg" src="/Blog/img/suka-lazyload.gif" alt="sunwengang's Avatar">
        <span>2021-06-07</span>
        
            <span class="suka-devide-dot"></span>
            <a class="category-link" href="/Blog/categories/android/">android</a>
        
        
            <!-- Busuanzi Post Views -->
<span id="busuanzi_container_page_pv" hidden>
    <span class="suka-devide-dot"></span>
    <span></span>
    <span id="busuanzi_value_page_pv"></span>
    <span>Views</span>
</span>
        
        
    </p>
    <div class="post-header-info-right">
        
            <div class="dropdown dropdown-right">
<a class="dropdown-toggle" tabindex="0">分享本文</a>
<ul class="menu share-menu">
    <!-- Share Weibo -->
    
    <li class="menu-item">
        <a href="http://service.weibo.com/share/share.php?appkey=&title=Android Display/Graphics调试技巧（六月份更新）&url=https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/&pic=https://alonealive.github.io/Blog/img/favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">分享到微博</a>
    </li>
    

    <!-- Share Twitter -->
    
    <li class="menu-item">
        <a href="https://twitter.com/intent/tweet?text=Android Display/Graphics调试技巧（六月份更新）&url=https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/&via=sunwengang" target="_blank" rel="external noopener noreferrer nofollow">分享到 Twitter</a>
    </li>
    

    <!-- Share Facebook -->
    
    <li class="menu-item">
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/" target="_blank" rel="external noopener noreferrer nofollow">分享到 Facebook</a>
    </li>
    

    <!-- Share Google+ -->
    
    <li class="menu-item">
        <a href="https://plus.google.com/share?url=https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/" target="_blank" rel="external noopener noreferrer nofollow">分享到 Google+</a>
    </li>
    

    <!-- Share LinkedIn -->
    
    <li class="menu-item">
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/&title=sunwengang blog" target="_blank" rel="external noopener noreferrer nofollow">分享到 LinkedIn</a>
    </li>
    

    <!-- Share QQ -->
    
    <li class="menu-item">
        <a href="http://connect.qq.com/widget/shareqq/index.html?site=sunwengang blog&title=sunwengang blog&summary=&pics=https://alonealive.github.io/Blog/img/favicon.ico&url=https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/" target="_blank" rel="external noopener noreferrer nofollow"> 分享到 QQ</a>
    </li>
    

    <!-- Share Telegram -->
    
    <li class="menu-item">
        <a href="https://t.me/share/url?url=https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/&text=sunwengang blog" target="_blank" rel="external noopener noreferrer nofollow">分享到 Telegram</a>
    </li>
    

    <!-- QRCode -->
    
    <li class="menu-item">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKQAAACkCAAAAAA83tqdAAACP0lEQVR42u2bwY7CMAwF+/8/vXtFVeI3rkDLxpML0IZ2imLHfjbXzz8Yl5BCCinkF0BexXg9/zp/9X51rfu5au7qe0LOhVwu2htkglu93oGqOcsfQcjRkCuDSQt+Z0irh6quv72ekEJuJu+gV1B0MxBSyHcZzs7Bp+NCCtmFLDf6EJymwPfjUZCQx0GmROxTr2/NFoU8BhIJR0UylgxpZzhvV9WEPAaSOu0qsK02hp3BIBFCyJGQq8WdhKsUMOyOdY4LORcyJVQ06ao+V8fKBxNyLGRyxjtRNBkUEQnK+wg5EpIYSrXIiVNP343igJCjIFOxsirIp6SKOvGteCXkSMhuIZ4kZ6n42Rb2hRwJmRxrClC74gASG4QcC0kKlKlI2jG0NF/I2ZBPGjOTgVGBNRqdkEICkapThH9UiO9WaYU8DpIkWCSJos0hjxpFhBwLSRuDq2SrcuqdJighZ0OmAKDjxBNgR1QVciZkEpc6hpKK+KSw3+5mEfJoSCrIJzGBCF7tTlQhx0CSmxERFDln0JAnpJDVDaukK51PSRspogo5G7KTvJNGpSeF+Wg4Qo6BTCI9cfrRCC7+B2AhhSTBbLc4SgrycQMQciRkGslQyGZAG0ajiCrkCEgiJlGhiQQdSUxoV2mFPBKSGEz1UAmCCAbLewk5GjI1d+wWeBXMEgMUUsgnkLSI3ikGkEBDSCFTgT0ZCRFdiYEJKSRtDukK9enBUgFKyLmQXSGJBrnEAKsfR8iZkN88hBRSSCH/cPwCtFt15DvExR8AAAAASUVORK5CYII=" alt="QRCode">
    </li>
    

</ul>
</div>
        
    </div>
</div>
                </div>
                <div class="card-body">
                    
                        
                        
                            <div id="post-toc"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#RenderThread渲染绘制（结合systrace）"><span class="post-toc-number">1.</span> <span class="post-toc-text">RenderThread渲染绘制（结合systrace）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#合成送显流程"><span class="post-toc-number">2.</span> <span class="post-toc-text">合成送显流程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#SurfaceFlinger模块"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">SurfaceFlinger模块</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#HWC模块"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">HWC模块</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#DRM模块"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">DRM模块</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Fence同步机制"><span class="post-toc-number">3.</span> <span class="post-toc-text">Fence同步机制</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Google平台帧率切换"><span class="post-toc-number">4.</span> <span class="post-toc-text">Google平台帧率切换</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#磁盘空间占满100"><span class="post-toc-number">5.</span> <span class="post-toc-text">磁盘空间占满100%</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Android设备分辨率、密度以及dp的理解"><span class="post-toc-number">6.</span> <span class="post-toc-text">Android设备分辨率、密度以及dp的理解</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#低内存分析方向和技巧"><span class="post-toc-number">7.</span> <span class="post-toc-text">低内存分析方向和技巧</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#查看进程占用内存情况"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">查看进程占用内存情况</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ubuntu查看公网ip"><span class="post-toc-number">8.</span> <span class="post-toc-text">ubuntu查看公网ip</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#查看视频解码的分辨率及对应的帧率支持"><span class="post-toc-number">9.</span> <span class="post-toc-text">查看视频解码的分辨率及对应的帧率支持</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#linux和windows书签同步"><span class="post-toc-number">10.</span> <span class="post-toc-text">linux和windows书签同步</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#getService配置权限"><span class="post-toc-number">11.</span> <span class="post-toc-text">getService配置权限</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#HIDL编写-升级流程"><span class="post-toc-number">12.</span> <span class="post-toc-text">HIDL编写&#x2F;升级流程</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ssk-key生成current-txt-hash值"><span class="post-toc-number">13.</span> <span class="post-toc-text">ssk-key生成current.txt hash值</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#修改git-remote-v的orign源"><span class="post-toc-number">14.</span> <span class="post-toc-text">修改git remote -v的orign源</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#git报错无法push（不建议使用）"><span class="post-toc-number">15.</span> <span class="post-toc-text">git报错无法push（不建议使用）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#git-commit修改作者名称"><span class="post-toc-number">16.</span> <span class="post-toc-text">git commit修改作者名称</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#gerrit拉取Andorid指定模块代码"><span class="post-toc-number">17.</span> <span class="post-toc-text">gerrit拉取Andorid指定模块代码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ubuntu命令查看dns"><span class="post-toc-number">18.</span> <span class="post-toc-text">ubuntu命令查看dns</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#markdown数学公式语法"><span class="post-toc-number">19.</span> <span class="post-toc-text">markdown数学公式语法</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#安装adb和fastboot"><span class="post-toc-number">20.</span> <span class="post-toc-text">安装adb和fastboot</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#针对image编译"><span class="post-toc-number">21.</span> <span class="post-toc-text">针对image编译</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#安装APK报错"><span class="post-toc-number">22.</span> <span class="post-toc-text">安装APK报错</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#查看当前前台app包名（实时）"><span class="post-toc-number">23.</span> <span class="post-toc-text">查看当前前台app包名（实时）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#监控设备实时获取当前的包名"><span class="post-toc-number">24.</span> <span class="post-toc-text">监控设备实时获取当前的包名</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#APP增加多国语言"><span class="post-toc-number">25.</span> <span class="post-toc-text">APP增加多国语言</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#native-crash分析"><span class="post-toc-number">26.</span> <span class="post-toc-text">native crash分析</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#YUV数据查看"><span class="post-toc-number">27.</span> <span class="post-toc-text">YUV数据查看</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#关闭硬件加速"><span class="post-toc-number">28.</span> <span class="post-toc-text">关闭硬件加速</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#linux绘图UML-序列图工具dia"><span class="post-toc-number">29.</span> <span class="post-toc-text">linux绘图UML&#x2F;序列图工具dia</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#屏幕旋转-转向切换命令"><span class="post-toc-number">30.</span> <span class="post-toc-text">屏幕旋转&#x2F;转向切换命令</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Surface两种合成方式（dump-sf）"><span class="post-toc-number">31.</span> <span class="post-toc-text">Surface两种合成方式（dump sf）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#getprop查看当前版本是user-userdebug"><span class="post-toc-number">32.</span> <span class="post-toc-text">getprop查看当前版本是user&#x2F;userdebug</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#getprop查看设备信息"><span class="post-toc-number">33.</span> <span class="post-toc-text">getprop查看设备信息</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#滑动到边缘Pixel值调试"><span class="post-toc-number">34.</span> <span class="post-toc-text">滑动到边缘Pixel值调试</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Input调试（PointerLocation）"><span class="post-toc-number">35.</span> <span class="post-toc-text">Input调试（PointerLocation）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#systrace查看"><span class="post-toc-number">35.1.</span> <span class="post-toc-text">systrace查看</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#点击input事件-up-down"><span class="post-toc-number">35.2.</span> <span class="post-toc-text">点击input事件(up&#x2F;down)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#input和wms的debug-log开关打开"><span class="post-toc-number">35.3.</span> <span class="post-toc-text">input和wms的debug log开关打开</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#FPS帧率测试"><span class="post-toc-number">36.</span> <span class="post-toc-text">FPS帧率测试</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#获取实时帧率（主要用于获取游戏-视频应用的fps数据）"><span class="post-toc-number">36.1.</span> <span class="post-toc-text">获取实时帧率（主要用于获取游戏&#x2F;视频应用的fps数据）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#dump-gfxinfo信息"><span class="post-toc-number">36.2.</span> <span class="post-toc-text">dump gfxinfo信息</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#查看帧率以及如何在systrace分析帧率"><span class="post-toc-number">36.3.</span> <span class="post-toc-text">查看帧率以及如何在systrace分析帧率</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#systrace中的Frame"><span class="post-toc-number">36.4.</span> <span class="post-toc-text">systrace中的Frame</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#屏幕录制视频（限定时间长）"><span class="post-toc-number">37.</span> <span class="post-toc-text">屏幕录制视频（限定时间长）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#截图命令"><span class="post-toc-number">37.1.</span> <span class="post-toc-text">截图命令</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#dump-sf查看buffer-layer列表"><span class="post-toc-number">38.</span> <span class="post-toc-text">dump sf查看buffer&#x2F;layer列表</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#dump-windows-inpu-sf"><span class="post-toc-number">38.1.</span> <span class="post-toc-text">dump windows&#x2F;inpu&#x2F;sf</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#源码打开input-debug日志开关"><span class="post-toc-number">39.</span> <span class="post-toc-text">源码打开input debug日志开关</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#adb打印kernel-log，即内核调试信息dmsg和kmsg"><span class="post-toc-number">40.</span> <span class="post-toc-text">adb打印kernel log，即内核调试信息dmsg和kmsg</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#合并kmsg-log"><span class="post-toc-number">40.1.</span> <span class="post-toc-text">合并kmsg log</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#查看设备的白名单"><span class="post-toc-number">41.</span> <span class="post-toc-text">查看设备的白名单</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Android-mk和Android-bp转换语法"><span class="post-toc-number">42.</span> <span class="post-toc-text">Android.mk和Android.bp转换语法</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#将HIDL接口服务从设备system移到vendor"><span class="post-toc-number">43.</span> <span class="post-toc-text">将HIDL接口服务从设备system移到vendor</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Android-bp（可参考）"><span class="post-toc-number">43.1.</span> <span class="post-toc-text">Android.bp（可参考）</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#C函数memset-…"><span class="post-toc-number">44.</span> <span class="post-toc-text">C函数memset(…)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#domain-te错误类型"><span class="post-toc-number">45.</span> <span class="post-toc-text">domain.te错误类型</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#查看手机硬件设备（包含屏幕信息）"><span class="post-toc-number">46.</span> <span class="post-toc-text">查看手机硬件设备（包含屏幕信息）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ubuntu的ll命令不能使用"><span class="post-toc-number">47.</span> <span class="post-toc-text">ubuntu的ll命令不能使用</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ubuntu挂载硬盘"><span class="post-toc-number">48.</span> <span class="post-toc-text">ubuntu挂载硬盘</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#find命令"><span class="post-toc-number">49.</span> <span class="post-toc-text">find命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#设置GPU频率"><span class="post-toc-number">49.1.</span> <span class="post-toc-text">设置GPU频率</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#☆CPU-GPU信息文件路径"><span class="post-toc-number">50.</span> <span class="post-toc-text">☆CPU&#x2F;GPU信息文件路径</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#加大dequeuebuffer数目"><span class="post-toc-number">51.</span> <span class="post-toc-text">加大dequeuebuffer数目</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#windows-cmd过滤log"><span class="post-toc-number">52.</span> <span class="post-toc-text">windows cmd过滤log</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#vscode插件"><span class="post-toc-number">53.</span> <span class="post-toc-text">vscode插件</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#抓取perfetto-trace（替代systrace）"><span class="post-toc-number">54.</span> <span class="post-toc-text">抓取perfetto-trace（替代systrace）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#systrace打开空白或者打不开"><span class="post-toc-number">54.1.</span> <span class="post-toc-text">systrace打开空白或者打不开</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#atrace转换到html"><span class="post-toc-number">54.2.</span> <span class="post-toc-text">atrace转换到html</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#systrace的类别和选项（直接添加）"><span class="post-toc-number">54.3.</span> <span class="post-toc-text">systrace的类别和选项（直接添加）</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#SElinux权限相关"><span class="post-toc-number">55.</span> <span class="post-toc-text">SElinux权限相关</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#自动生成selinux权限代码"><span class="post-toc-number">55.1.</span> <span class="post-toc-text">自动生成selinux权限代码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#开启-关闭Selinux权限"><span class="post-toc-number">55.2.</span> <span class="post-toc-text">开启&#x2F;关闭Selinux权限</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#进入fastboot"><span class="post-toc-number">56.</span> <span class="post-toc-text">进入fastboot</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#LCD屏幕低温残影现象"><span class="post-toc-number">57.</span> <span class="post-toc-text">LCD屏幕低温残影现象</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#makefile"><span class="post-toc-number">58.</span> <span class="post-toc-text">makefile</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#亮度单位nit"><span class="post-toc-number">59.</span> <span class="post-toc-text">亮度单位nit</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#光学单位lux"><span class="post-toc-number">59.1.</span> <span class="post-toc-text">光学单位lux</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#启动activity-关闭activity"><span class="post-toc-number">60.</span> <span class="post-toc-text">启动activity&#x2F;关闭activity</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Git命令"><span class="post-toc-number">61.</span> <span class="post-toc-text">Git命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#查看代码提交历史（具体到某一行）"><span class="post-toc-number">61.1.</span> <span class="post-toc-text">查看代码提交历史（具体到某一行）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#提交代码"><span class="post-toc-number">61.2.</span> <span class="post-toc-text">提交代码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#提交草稿代码"><span class="post-toc-number">61.3.</span> <span class="post-toc-text">提交草稿代码</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#提交代码、sync代码报错Agent-admitted-failure-to-sign-using-the-key"><span class="post-toc-number">62.</span> <span class="post-toc-text">提交代码、sync代码报错Agent admitted failure to sign using the key</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#apt-get报错不能进行正常更新"><span class="post-toc-number">63.</span> <span class="post-toc-text">apt-get报错不能进行正常更新</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ubuntu自带截图快捷键"><span class="post-toc-number">64.</span> <span class="post-toc-text">ubuntu自带截图快捷键</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#gedit乱码"><span class="post-toc-number">65.</span> <span class="post-toc-text">gedit乱码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#跳过开机向导"><span class="post-toc-number">66.</span> <span class="post-toc-text">跳过开机向导</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ubuntu快速下载命令"><span class="post-toc-number">67.</span> <span class="post-toc-text">ubuntu快速下载命令</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#谷歌GMS服务"><span class="post-toc-number">68.</span> <span class="post-toc-text">谷歌GMS服务</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#GMS测试注意事项"><span class="post-toc-number">68.1.</span> <span class="post-toc-text">GMS测试注意事项</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#常见问题"><span class="post-toc-number">68.2.</span> <span class="post-toc-text">常见问题</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#开机向导设置密码后关机再开机黑屏"><span class="post-toc-number">68.2.1.</span> <span class="post-toc-text">开机向导设置密码后关机再开机黑屏</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Play-Store无法正常连接"><span class="post-toc-number">68.2.2.</span> <span class="post-toc-text">Play Store无法正常连接</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Play-Store下载应用失败"><span class="post-toc-number">68.2.3.</span> <span class="post-toc-text">Play Store下载应用失败</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#GMS应用首次登陆闪退，第二次正常"><span class="post-toc-number">68.2.4.</span> <span class="post-toc-text">GMS应用首次登陆闪退，第二次正常</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#GMS应用缺少部分菜单"><span class="post-toc-number">68.2.5.</span> <span class="post-toc-text">GMS应用缺少部分菜单</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#GMS部分应用联网后消失"><span class="post-toc-number">68.2.6.</span> <span class="post-toc-text">GMS部分应用联网后消失</span></a></li></ol></li></ol></li></ol></div>
                        
                    
                    <article id="post-content">
                        <blockquote>
<p>android display/graphics相关的调试方法和优化工作效率技巧整理</p>
</blockquote>
<a id="more"></a>

<h2 id="RenderThread渲染绘制（结合systrace）"><a href="#RenderThread渲染绘制（结合systrace）" class="headerlink" title="RenderThread渲染绘制（结合systrace）"></a>RenderThread渲染绘制（结合systrace）</h2><blockquote>
<p>参考：<a href="https://zhuanlan.zhihu.com/p/145219630" target="_blank" rel="noopener">Android Systrace 基础知识(7) - Vsync 解读</a><br>参考：<a href="https://blog.csdn.net/hexiaolong2009/article/details/99225637" target="_blank" rel="noopener">BufferQueue 学习总结（内附动态图）</a><br>参考：<a href="https://blog.csdn.net/weixin_29587979/article/details/113043321" target="_blank" rel="noopener">android 判断list里有这条数据_Android图形渲染原理（中）</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">----</span><br><span class="line">frameworks&#x2F;base&#x2F;libs&#x2F;hwui&#x2F;renderthread   -- DrawFrameTask::drawFrame()   -----&gt;</span><br><span class="line">DrawFrameTask::postAndWait()   ----&gt;</span><br><span class="line">DrawFrameTask::run()    -----&gt;</span><br><span class="line">(1) DrawFrameTask::syncFrameState  同步Frame的State  ----&gt;</span><br><span class="line">CanvasContext::prepareTree</span><br><span class="line">(2) context-&gt;draw()   绘制    ------&gt;</span><br><span class="line">frameworks&#x2F;base&#x2F;libs&#x2F;hwui&#x2F;renderthread  -- CanvasContext::draw()   ----&gt;</span><br><span class="line">----</span><br><span class="line">(1) frameworks&#x2F;base&#x2F;libs&#x2F;hwui&#x2F;pipeline&#x2F;skia  -- SkiaOpenGLPipeline::getFrame()  ----&gt;</span><br><span class="line">frameworks&#x2F;base&#x2F;libs&#x2F;hwui&#x2F;renderthread&#x2F;EglManager.cpp - EglManager::beginFrame ----&gt;</span><br><span class="line">(1.1)EglManager::makeCurrent  -----&gt;</span><br><span class="line">frameworks&#x2F;native&#x2F;opengl&#x2F;libs&#x2F;EGL&#x2F;eglApi.cpp -- eglMakeCurrent ---&gt;</span><br><span class="line">frameworks&#x2F;native&#x2F;libs&#x2F;nativewindow&#x2F;ANativeWindow.cpp -- ANativeWindow_dequeueBuffer ----&gt;</span><br><span class="line">frameworks&#x2F;native&#x2F;libs&#x2F;gui&#x2F;Surface.cpp -- Surface::dequeueBuffer (&#96;systrace: HWC release&#96;)</span><br><span class="line"></span><br><span class="line">(1.2)EglManager::queryBufferAge</span><br><span class="line">----</span><br><span class="line">(2) SkiaOpenGLPipeline::draw()   ----&gt;</span><br><span class="line">(2.1) EglManager::damageFrame</span><br><span class="line">(2.2) SkiaPipeline::renderFrame (&#96;systrace:flush commands&#96; 后调用，systrace显示在后)[---&gt;SkiaPipeline::renderOverdraw]  ---&gt;</span><br><span class="line">SkiaPipeline::renderFrameImpl (先调用，systrace显示在前)  ---&gt;</span><br><span class="line">RenderNodeDrawable::onDraw  ----&gt;</span><br><span class="line">RenderNodeDrawable::forceDraw  [------&gt;RenderNodeDrawable::drawBackwardsProjectedNodes] ----&gt; </span><br><span class="line">RenderNodeDrawable::drawContent   ----&gt;</span><br><span class="line">RenderNodeDrawable::setViewProperties (&#96;systrace:alpha caused saveLayer&#96;)</span><br><span class="line">----</span><br><span class="line">(3) SkiaOpenGLPipeline::swapBuffers   -----&gt;</span><br><span class="line">frameworks&#x2F;native&#x2F;opengl&#x2F;libs&#x2F;EGL&#x2F;eglApi.cpp -- eglSwapBuffersWithDamageKHR   ----&gt;</span><br><span class="line">frameworks&#x2F;native&#x2F;libs&#x2F;nativewindow&#x2F;ANativeWindow.cpp -- ANativeWindow_queueBuffer  ---&gt;</span><br><span class="line">frameworks&#x2F;native&#x2F;libs&#x2F;gui&#x2F;Surface.cpp -- Surface::queueBuffer  (&#96;systrace: gpu completion&#96;绘制完成)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="合成送显流程"><a href="#合成送显流程" class="headerlink" title="合成送显流程"></a>合成送显流程</h2><blockquote>
<p>Android Q，非最新AOSP流程，有变动</p>
</blockquote>
<h3 id="SurfaceFlinger模块"><a href="#SurfaceFlinger模块" class="headerlink" title="SurfaceFlinger模块"></a>SurfaceFlinger模块</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SurfaceFlinger::handleMessageRefresh();</span><br><span class="line">  preComposition();</span><br><span class="line">  rebuildLayerStacks();</span><br><span class="line">  calculateWorkingSet();</span><br><span class="line">  doComposition();</span><br><span class="line">    doDisplayComposition();</span><br><span class="line">    postFramebuffer();</span><br><span class="line">      HWComposer::presentAndGetReleaseFences();</span><br><span class="line">        HWC2::Display::present();</span><br><span class="line">          Composer::presentDisplay();</span><br></pre></td></tr></table></figure>

<h3 id="HWC模块"><a href="#HWC模块" class="headerlink" title="HWC模块"></a>HWC模块</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">HWCSession::PresentDisplay();</span><br><span class="line">  HWCDisplayBuiltIn::Present();</span><br><span class="line">    HWCDisplayBuiltIn::CommitLayerStack();</span><br><span class="line">      HWCDisplay::CommitLayerStack();</span><br><span class="line">        DisplayBuiltIn::Commit();</span><br><span class="line">          DisplayBase::Commit();</span><br><span class="line">            HWPeripheralDRM::Commit();</span><br><span class="line">               HWDeviceDRM::Commit();</span><br><span class="line">                 HWDeviceDRM::AtomicCommit();</span><br><span class="line">                   DRMAtomicReq::Commit();</span><br><span class="line">                     drmModeAtomicCommit();</span><br></pre></td></tr></table></figure>

<h3 id="DRM模块"><a href="#DRM模块" class="headerlink" title="DRM模块"></a>DRM模块</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">msm_atomic_commit();</span><br><span class="line">  msm_atomic_commit_dispatch();</span><br><span class="line">    kthread_queue_work(commit-&gt;commit_work);</span><br><span class="line"> </span><br><span class="line">_msm_drm_commit_work_cb();</span><br><span class="line">  complete_commit();</span><br><span class="line">    drm_atomic_helper_commit_planes();</span><br><span class="line">      sde_crtc_atomic_begin();</span><br><span class="line">        _sde_crtc_setup_mixers();</span><br><span class="line">        _sde_crtc_blend_setup();</span><br><span class="line">          _sde_crtc_blend_setup_mixer();</span><br><span class="line">            _sde_crtc_setup_blend_cfg(); &#x2F;&#x2F; blend_op</span><br><span class="line">        _sde_crtc_dest_scaler_setup();</span><br><span class="line">      sde_plane_atomic_update();</span><br><span class="line">        sde_plane_sspp_atomic_update();</span><br><span class="line">      sde_crtc_atomic_flush();</span><br><span class="line">        sde_plane_flush();</span><br><span class="line">    msm_atomic_helper_commit_modeset_enables();</span><br><span class="line">      sde_crtc_enable();</span><br><span class="line">      sde_encoder_virt_enable();</span><br><span class="line">        sde_encoder_resource_control(SDE_ENC_RC_EVENT_KICKOFF);</span><br><span class="line">        _sde_encoder_virt_enable_helper();</span><br><span class="line">          hw_mdptop-&gt;ops.reset_ubwc();</span><br><span class="line">          hw_ctl-&gt;ops.setup_intf_cfg_v1();</span><br><span class="line">          _sde_encoder_update_vsync_source();</span><br><span class="line">            sde_encoder_phys_cmd_setup_vsync_source();</span><br><span class="line">              sde_hw_intf_vsync_sel();</span><br><span class="line">          sde_encoder_control_te();</span><br><span class="line">            sde_encoder_phys_cmd_connect_te();</span><br><span class="line">              sde_hw_intf_connect_external_te();</span><br><span class="line">      sde_kms_commit();</span><br><span class="line">        sde_crtc_commit_kickoff();</span><br><span class="line">          sde_encoder_prepare_for_kickoff();</span><br><span class="line">      drm_bridge_enable();</span><br><span class="line">        dsi_bridge_enable();</span><br><span class="line">    msm_atomic_wait_for_commit_done();</span><br><span class="line">      sde_kms_wait_for_commit_done();</span><br><span class="line">        sde_encoder_wait_for_event(MSM_ENC_COMMIT_DONE);</span><br><span class="line">        sde_crtc_complete_flip();</span><br><span class="line">          drm_crtc_send_vblank_event();</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Fence同步机制"><a href="#Fence同步机制" class="headerlink" title="Fence同步机制"></a>Fence同步机制</h2><p><code>DummySwSyncTimeline CreateDummyFence()</code>创建软件模拟fence</p>
<p><strong>核心只有两件事情：</strong></p>
<ol>
<li>sw_sync_fence_create 创建一个软件模拟的fence</li>
<li>sw_sync_timeline_inc sync_timeline 时间轴向后推一个时间同步点</li>
</ol>
<p>BufferSlot对应的BufferItem中的mFence对象就是Fence类，最后会在setUpHwcComposer中<code>prepareFrame</code>设置到Hal中</p>
<p>在Android Framework中有一个用于操作fence同步栅的类（libsync中sync_wait类）</p>
<hr>
<h2 id="Google平台帧率切换"><a href="#Google平台帧率切换" class="headerlink" title="Google平台帧率切换"></a>Google平台帧率切换</h2><blockquote>
<p>参考：<a href="https://blog.csdn.net/u014535072/article/month/2020/05" target="_blank" rel="noopener">Android UI架构四、五</a><br>参考：<a href="https://blog.csdn.net/u014535072/article/month/2020/09" target="_blank" rel="noopener">Android UI架构十、十一</a></p>
</blockquote>
<p><strong>关键函数：</strong></p>
<ul>
<li><p>setFrameRate</p>
</li>
<li><p>getRefreshRate</p>
</li>
<li><p>app:    用于接收vsync信号并且上报给App进程，App开始画图    属性名：VSYNC_EVENT_PHASE_OFFSET_NS</p>
</li>
<li><p>sf:    用于SurfaceFlinger接收vsync信号用于渲染    属性名：SF_VSYNC_EVENT_PHASE_OFFSET_NS</p>
</li>
</ul>
<hr>
<h2 id="磁盘空间占满100"><a href="#磁盘空间占满100" class="headerlink" title="磁盘空间占满100%"></a>磁盘空间占满100%</h2><ol>
<li>使用命令 <code>sudo du -sh *</code> 查看各个目录的占内存情况，使用<code>du -h -x --max-depth=1</code>查看哪个深度1的目录占用过高</li>
<li>如果发现<code>/usr/local/tomcat</code>的目录占用的磁盘空间特别大,则进入该目录，发现logs的目录特别大,Tomcat的日志太大,可以将其删除。比如本地电脑发现<code>~/.cache/vmware</code>目录下的drag_and_drop文件很大，这是因为虚拟机和主系统之间每次拖拉文件，都会生成一个复制文件，造成该文件越来越大，可以删除。</li>
<li>再使用<code>df -h</code>发现磁盘空间</li>
</ol>
<h2 id="Android设备分辨率、密度以及dp的理解"><a href="#Android设备分辨率、密度以及dp的理解" class="headerlink" title="Android设备分辨率、密度以及dp的理解"></a>Android设备分辨率、密度以及dp的理解</h2><blockquote>
<p>参考：<a href="https://www.longdw.com/2013/04/18/android-px-dp/" target="_blank" rel="noopener">Android设备分辨率、密度以及dp的理解</a><br>参考：<a href="https://www.zcool.com.cn/article/ZNjI3NDQ=.html" target="_blank" rel="noopener">UI设计师不可不知的安卓屏幕知识</a></p>
</blockquote>
<ul>
<li>dpi计算方法：</li>
</ul>
<ol>
<li>分辨率的平方和开方（勾股定理） <code>adb shell wm size</code></li>
<li>然后除以屏幕的物理英寸，即是dpi</li>
</ol>
<p><code>adb shell wm density</code>可以查看当前的dpi（一般有的手机会在计算的结果上调整）</p>
<ul>
<li>dp计算方法（开发者选项最小宽度dp）</li>
</ul>
<p>1.<code>在安卓中，系统密度为160dpi的中密度手机屏幕为基准屏幕，即320×480的手机屏幕。在这个屏幕中，1dp=1px</code><br>2.分辨率的宽高分别除以dpi，获取到<code>sw320dp,h533dp</code>值</p>
<p>可通过<code>adb shell dumpsys window</code>查看到</p>
<h2 id="低内存分析方向和技巧"><a href="#低内存分析方向和技巧" class="headerlink" title="低内存分析方向和技巧"></a>低内存分析方向和技巧</h2><blockquote>
<p>参考：<a href="https://wizzie.top/Blog/2020/08/06/2020/200806_android_ANR_BaseLog/" target="_blank" rel="noopener">Android ANR基本Log分析</a></p>
</blockquote>
<blockquote>
<p>参考：<a href="https://mp.weixin.qq.com/s/z5Tlh5KwFFaVpJWrU2IRAA" target="_blank" rel="noopener">Android 系统内存耗用：VSS/RSS/PSS/USS 的介绍</a></p>
</blockquote>
<p><strong>dumpsys meminfo:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Total RAM: 2,697,524K (status normal)</span><br><span class="line"> Free RAM: 1,063,563K (  252,355K cached pss +   717,200K cached kernel +         0K cached ion +    94,008K free)</span><br><span class="line">      ION:   189,688K (    7,624K mapped +   182,064K unmapped +         0K pools)</span><br><span class="line"> totalSwapPss:   775,324K kernelCached:   272,476K</span><br><span class="line"> Used RAM: 2,677,904K (2,090,100K used pss +   587,804K kernel)</span><br><span class="line"> Lost RAM:   -23,995K</span><br><span class="line">     ZRAM:   200,100K physical used for   669,848K in swap (1,572,860K total swap)</span><br><span class="line">   Tuning: 128 (large 512), oom   322,560K, restore limit   107,520K (high-end-gfx)</span><br><span class="line">--------- 14.816s was the duration of dumpsys meminfo, ending at: 2021-01-05 16:09:23</span><br></pre></td></tr></table></figure>

<h3 id="查看进程占用内存情况"><a href="#查看进程占用内存情况" class="headerlink" title="查看进程占用内存情况"></a>查看进程占用内存情况</h3><p><code>adb shell procrank</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  PID       Vss      Rss      Pss      Uss     Swap    PSwap    USwap    ZSwap  cmdline</span><br><span class="line"> 1195  9776476K  509716K  228733K  166648K    3748K     405K     352K      78K  system_server</span><br><span class="line"> 5466  7005964K  351036K  139327K  123836K    3404K      53K       0K      10K  com.android.systemui</span><br><span class="line">.....</span><br></pre></td></tr></table></figure>

<ul>
<li>VSS： 一个进程总共可访问的地址空间。其大小还包括了可能不在RAM中的内存（比如虽然malloc分配了空间，但尚未写入）。 VSS 很少被用于判断一个进程的真实内存使用量</li>
<li>RSS： 一个进程在RAM中真实存储的总内存。<strong>仅仅表示该进程所使用的所有共享库的大小，而不管有多少个进程使用该共享库，该共享库仅被加载到内存一次。所以RSS并不能准确反映单进程的内存占用情况</strong></li>
<li>PSS： 按比例表示使用的共享库。系统中所有进程的PSS都相加的话，就刚好反映了系统中的总共占用的内存。而当一个进程被销毁之后， 其占用的共享库那部分比例的PSS，将会再次按比例分配给余下使用该库的进程</li>
<li>USS： 进程所占用的私有内存（内存泄漏的最佳观察数据）。不包含so库占用内存的</li>
</ul>
<hr>
<h2 id="ubuntu查看公网ip"><a href="#ubuntu查看公网ip" class="headerlink" title="ubuntu查看公网ip"></a>ubuntu查看公网ip</h2><p>三种方法：</p>
<ol>
<li><code>curl www.icanhazip.com</code></li>
<li><code>curl ifconfig.me</code></li>
<li><code>curl -4sSkL https://myip.ipip.net</code></li>
</ol>
<hr>
<h2 id="查看视频解码的分辨率及对应的帧率支持"><a href="#查看视频解码的分辨率及对应的帧率支持" class="headerlink" title="查看视频解码的分辨率及对应的帧率支持"></a>查看视频解码的分辨率及对应的帧率支持</h2><p>日志关键词<code>MediaCodec</code></p>
<p>配置文件：<code>/vendor/etc/media_codecs.xml</code></p>
<hr>
<h2 id="linux和windows书签同步"><a href="#linux和windows书签同步" class="headerlink" title="linux和windows书签同步"></a>linux和windows书签同步</h2><p>about:config网址搜索sync：</p>
<ul>
<li><code>identity.sync.tokenserver.uri</code>：</li>
</ul>
<p>修改：</p>
<ul>
<li><p>linux：<code>https://sync.firefox.com.cn/token/1.0/sync/1.5</code></p>
</li>
<li><p>windows：<code>https://token.services.mozilla.com/1.0/sync/1.5</code></p>
</li>
</ul>
<hr>
<h2 id="getService配置权限"><a href="#getService配置权限" class="headerlink" title="getService配置权限"></a>getService配置权限</h2><p>首先getService获取服务，紧接着就是getTransport的接口调用。如果在配置文件里面没找到我们所要求的服务，就会报错并结束服务的获取</p>
<ul>
<li>首先会去<code>system/etc/vintf/manifest.xm</code>l文件去找我们调用者的服务名，如果找到就返回。</li>
<li>如果没找到就会去<code>vendor/etc/vintf/manifest.xml</code>文件去找，如果找到就返回。如果没找到则返回NULLPRT。同时打印<code>Cannot find entry xxx in either framework or device manifest.</code></li>
</ul>
<p>所以，如果碰到这样的log，首先要去检测这两个文件里面有没有配置我们调用的服务，没有就要自己配置。</p>
<p>一般是没有配置引起的，当然也有可能是xml增加的语法有问题，比如格式对齐等。</p>
<hr>
<h2 id="HIDL编写-升级流程"><a href="#HIDL编写-升级流程" class="headerlink" title="HIDL编写/升级流程"></a>HIDL编写/升级流程</h2><blockquote>
<p>参考：<a href="https://www.cnblogs.com/caidi/p/13214913.html" target="_blank" rel="noopener">VINTF</a><br>参考：<a href="http://ddrv.cn/a/238197" target="_blank" rel="noopener">VINTF简介</a><br>参考：<a href="https://source.android.google.cn/devices/architecture/vintf" target="_blank" rel="noopener">供应商接口对象</a></p>
</blockquote>
<p>总体流程:</p>
<ol>
<li>创建HIDL接口文件<code>XXX.hal</code>：HIDL为每个HAL模块设计了不同接口定义hal文件，以<code>.hal</code>结尾，在<code>hidl-gen</code>工具的帮助下即可自动编译生成对应接口C++实现或者Java实现</li>
<li><code>hidl-gen</code>生成<code>interface hash</code>, 添加至current.txt</li>
<li><code>hidl-gen</code>生成接口,更新<code>接口, XXX.bp, XXX.mk</code>等</li>
<li>更新vendor manifest文件：对于TA开发来说, 底层TA是服务提供者(需求提供者), 因此提供的是manifest(vendor), 将<code>vintf/manifests.xml</code>push到设备端:<code>adb push manifest.xml /vendor/etc/vintf</code>；system(framwork是发起需求者,需要设什么样的需求), 这部分内容在新平台上也在<code>vintf/manifests.xml</code>，push到设备端:<code>adb push compatibity.device.xml  /system/etc/vintf</code></li>
<li>更新fcm(matrix)，即compatibility matrix XML编写：manifest文件描述了提供给对方的feature, Matrix描述了需要对方提供什么样的feature. Manifest和Matrix在OTA升级之前会进行匹配检查, 确保framework和device是兼容的, 总的来说,manifest是feature提供端, matrix是feature需求端</li>
</ol>
<ul>
<li>关于compatibility Matrices：</li>
<li><ul>
<li><code>framework compatibility matrix</code>：描述了framwork对device的需求, 这个matrix文件是和system.img关联的, 这些需求需要被device manifest支持</li>
</ul>
</li>
<li><ul>
<li><code>device compatibility matrix</code>：描述了device对framework的需求</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//xml manifest语法</span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">version</span>=<span class="string">"1.0"</span> <span class="attr">type</span>=<span class="string">"device"</span>&gt;</span>   //version: 必选, manifest的主版本号；type: 必选, manifest的类型,属于vendor,值为device; 属于system,值为framework</span><br><span class="line">    <span class="tag">&lt;<span class="name">hal</span> <span class="attr">format</span>=<span class="string">"hidl"</span>&gt;</span>    //hal:可选,可以存在多个,代表HAL(HIDL或者native); format:可选, 值为hidl(默认),或者native,分别代表HIDL和native HALS</span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>vendor.android.hardware.test<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  // name 必选, 代表HAL的合规包名</span><br><span class="line">        <span class="tag">&lt;<span class="name">transport</span>&gt;</span>hwbinder<span class="tag">&lt;/<span class="name">transport</span>&gt;</span>  // 和format有关,format的值是hidl时，就是必选的，否则不必存在.申明了当这个包的接口被service manager查询时将使用何种transport方式</span><br><span class="line">                                         // 可以是hwbinder,代表绑定式hidl, 也可以是passthrough: 代表直通式hide</span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  //必选, 代表当前hidl的版本号</span><br><span class="line">        <span class="tag">&lt;<span class="name">interface</span>&gt;</span>             // 必选的,可以多个但是不能重复,声明了一个含有实例的接口</span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>ITestService<span class="tag">&lt;/<span class="name">name</span>&gt;</span> //必选  接口实例的名字</span><br><span class="line">            <span class="tag">&lt;<span class="name">instance</span>&gt;</span>default<span class="tag">&lt;/<span class="name">instance</span>&gt;</span> //必选,不可重复</span><br><span class="line">        <span class="tag">&lt;/<span class="name">interface</span>&gt;</span></span><br><span class="line">        .....</span><br></pre></td></tr></table></figure>

<p>结构层级:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">manifest:version  type &#x2F;&#x2F;这一层级申明当前manifest</span><br><span class="line">|--hal format 第二层级</span><br><span class="line">    |--name</span><br><span class="line">    |--transtport</span><br><span class="line">    |--version</span><br><span class="line">    |-- interface</span><br><span class="line">      |-- name</span><br><span class="line">      |-- instance</span><br><span class="line">|--sepolicy</span><br><span class="line">  |--version</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>启动服务:首先需要将生成的库文件和服务守护进程分别push到设备端, 其次, 使用<code>lshal</code>查看对应的服务是否启动,如果为启动,需要查看对应的rc文件是否存在, 若不存在,则<code>push(vendor/etc/xxx.rc)</code>, 手动启服务</li>
</ol>
<ul>
<li><p>概念：hidl接口哈希,是一种旨在防止意外更改接口,并确保接口更改经过全面审查的机制.因为HIDL接口带有版本号, 因此,接口一旦发布就bade在更改</p>
</li>
<li><p>布局：每个软件包根目录,都必须包含一个列出所有已经发布的HIDL接口的current.txt文件</p>
</li>
<li><p>使用hidl-gen添加哈希：hidl-gen生成的每个接口定义库都包含哈希，通过调用<code>IBase::getHashChain</code>可检索这些哈希。hidl-gen 编译接口时，会检查HAL软件包根目录中的current.txt 文件，以查看HAL是否已被更改</p>
</li>
<li><ul>
<li>如果没有找到HAL的哈希，则接口会被视为未发布（处于开发阶段），并且编译会继续进行</li>
</ul>
</li>
<li><ul>
<li>如果找到了相应哈希，则会对照当前接口对其进行检查</li>
</ul>
</li>
</ul>
<p>如果接口与哈希匹配，则编译会继续进行</p>
<p>如果接口与哈希不匹配，则编译会暂停，因为这意味着之前发布的接口会被更改</p>
<p>如要进行保留ABI的更改（ABI稳定性），必须先修改current.txt文件，然后编译才能继续进行</p>
<p>所有其他更改都应在接口的minor或major版本升级中进行</p>
<p>Tips：</p>
<ul>
<li>查看HIDL编写的hal服务是否启动：<code>adb shell lshal</code></li>
</ul>
<ol start="7">
<li>重启</li>
</ol>
<h2 id="ssk-key生成current-txt-hash值"><a href="#ssk-key生成current-txt-hash值" class="headerlink" title="ssk-key生成current.txt hash值"></a>ssk-key生成current.txt hash值</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ hidl-gen -L hash -r vendor.....Testservice（service名称）:&#x2F;vendor&#x2F;...&#x2F;interfaces&#x2F;Testservice（路径） -r android.hidl:system&#x2F;libhidl&#x2F;transport vendor...Testservice@1.0</span><br><span class="line"></span><br><span class="line">e147fb59c6ffd19c8ea7345423e6b99d8d450e6078ff40367122a9c4ee005da5 vendor...Testservice@1.0::types</span><br><span class="line">8f202376e0d66fa4c9448d71415993994de99150b7326e32ac5a04b4b94aec09 vendor....Testservice@1.0::ITestQservice</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="修改git-remote-v的orign源"><a href="#修改git-remote-v的orign源" class="headerlink" title="修改git remote -v的orign源"></a>修改git remote -v的orign源</h2><ol>
<li><code>git remote -v</code>查看远程提交信息</li>
<li><code>git remote rm origin</code>删除</li>
<li>添加：<code>git remote add origin (正确的信息)ssh://..../platform/frameworks/native</code></li>
<li><code>git remote -v</code>查看，如果push未修改成功没有关系</li>
<li>提交代码，记得加上<code>-u</code>选项：<code>git push -u orign master</code></li>
</ol>
<hr>
<h2 id="git报错无法push（不建议使用）"><a href="#git报错无法push（不建议使用）" class="headerlink" title="git报错无法push（不建议使用）"></a>git报错无法push（不建议使用）</h2><p>报错信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fatal: Unpack error, check server log</span><br><span class="line">error: remote unpack failed: error Missing tree 7d3329b06421654faca962eab6cb6f9da6b47b9f</span><br></pre></td></tr></table></figure>

<p>使用：<code>git push --no-thin origin dev</code></p>
<h2 id="git-commit修改作者名称"><a href="#git-commit修改作者名称" class="headerlink" title="git commit修改作者名称"></a>git commit修改作者名称</h2><p><code>git commit --amend --author=&quot;wizzie &lt;wizzie@test.com&gt;&quot;</code></p>
<h2 id="gerrit拉取Andorid指定模块代码"><a href="#gerrit拉取Andorid指定模块代码" class="headerlink" title="gerrit拉取Andorid指定模块代码"></a>gerrit拉取Andorid指定模块代码</h2><ol>
<li>repo init</li>
<li>gerrit提交代码的界面projects里面搜索要拉取的指定模块</li>
<li>复制<code>git clone</code>然后本地执行</li>
<li><code>git branch -a</code>查看所有分支，然后<code>git checkout 分支名</code>（不包含orign/master）</li>
<li>git pull</li>
</ol>
<hr>
<h2 id="ubuntu命令查看dns"><a href="#ubuntu命令查看dns" class="headerlink" title="ubuntu命令查看dns"></a>ubuntu命令查看dns</h2><p><code>nm-tool</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- Device: eth0  [Auto Ethernet] ------------------------------------------------</span><br><span class="line">  Type:              Wired</span><br><span class="line">  Driver:            e1000e</span><br><span class="line">  State:             connected</span><br><span class="line">  Default:           yes</span><br><span class="line">  HW Address:        ...:5D</span><br><span class="line"></span><br><span class="line">  Capabilities:</span><br><span class="line">    Carrier Detect:  yes</span><br><span class="line">    Speed:           1000 Mb&#x2F;s</span><br><span class="line"></span><br><span class="line">  Wired Properties</span><br><span class="line">    Carrier:         on</span><br><span class="line"></span><br><span class="line">  IPv4 Settings:</span><br><span class="line">    Address:         ....241</span><br><span class="line">    Prefix:          24 (255.255.255.0)</span><br><span class="line">    Gateway:         ....1</span><br><span class="line"></span><br><span class="line">    DNS:             ....74</span><br><span class="line">    DNS:             ....75</span><br><span class="line">    DNS:             ....73</span><br></pre></td></tr></table></figure>

<h2 id="markdown数学公式语法"><a href="#markdown数学公式语法" class="headerlink" title="markdown数学公式语法"></a>markdown数学公式语法</h2><blockquote>
<p>参考：<a href="https://www.jianshu.com/p/e74eb43960a1" target="_blank" rel="noopener">Markdown数学公式语法</a></p>
</blockquote>
<ul>
<li><p>行内公式：将公式插入到本行内，符号：<code>$公式内容$</code>，如：$xyz$</p>
</li>
<li><p>独行公式：将公式插入到新的一行内，并且居中，符号：<code>$$公式内容$$</code>，如：$$xyz$$</p>
</li>
<li><p>上标符号，符号：^，如：$x^4$</p>
</li>
<li><p>下标符号，符号：_，如：$x_1$</p>
</li>
<li><p>组合符号，符号：{}，如：${16}<em>{8}O{2+}</em>{2}$</p>
</li>
</ul>
<h2 id="安装adb和fastboot"><a href="#安装adb和fastboot" class="headerlink" title="安装adb和fastboot"></a>安装adb和fastboot</h2><p><code>sudo apt-get install android-tools-adb</code></p>
<p><code>sudo apt-get install android-tools-fastboot</code></p>
<p>或者使用Android SDK/platform-tools</p>
<h2 id="针对image编译"><a href="#针对image编译" class="headerlink" title="针对image编译"></a>针对image编译</h2><ol>
<li>编译所有image</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source build&#x2F;envsetup.sh</span><br><span class="line">lunch XX-userdebug</span><br><span class="line">.&#x2F;build.sh dist -j4</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>编译system.img，生成在qssi目录下</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source build&#x2F;envsetup.sh</span><br><span class="line">lunch xx-userdebug</span><br><span class="line">.&#x2F;build.sh dist qssi_only -j4</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>编译super.img</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source build&#x2F;envsetup.sh</span><br><span class="line">lunch xx-userdebug</span><br><span class="line">.&#x2F;build.sh dist merge_only -j4</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>编译其它img，例如vendorimage（如果不指定会编译其它所有img）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source build&#x2F;envsetup.sh</span><br><span class="line">lunch xx-userdebug</span><br><span class="line">.&#x2F;build.sh vendorimage dist target_only -j4</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="安装APK报错"><a href="#安装APK报错" class="headerlink" title="安装APK报错"></a>安装APK报错</h2><p>如果安装APK报错，控制台输出如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ adb install test.apk</span><br><span class="line">5451 KB&#x2F;s (635477 bytes in 0.113s)</span><br><span class="line">Failure [INSTALL_FAILED_UPDATE_INCOMPATIBLE: Package com.debug.test signatures do not match previously installed version; ignoring!]</span><br></pre></td></tr></table></figure>

<p>需要先删除原先的APK，并且清楚缓存，重启：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">adb shell dumpsys activity top|grep ACTIVITY</span><br><span class="line">adb shell pm path com.debug.test</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;删除卸载原APK</span><br><span class="line">adb shell rm -rf ***</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;清楚缓存</span><br><span class="line">adb shell pm clear com.debug.test</span><br><span class="line">adb reboot</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;再次安装新的APK</span><br><span class="line">adb install test.apk</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="查看当前前台app包名（实时）"><a href="#查看当前前台app包名（实时）" class="headerlink" title="查看当前前台app包名（实时）"></a>查看当前前台app包名（实时）</h2><p><code>adb shell dumpsys window | grep mCurrentFocus</code></p>
<h2 id="监控设备实时获取当前的包名"><a href="#监控设备实时获取当前的包名" class="headerlink" title="监控设备实时获取当前的包名"></a>监控设备实时获取当前的包名</h2><p><code>adb shell am monitor</code></p>
<h2 id="APP增加多国语言"><a href="#APP增加多国语言" class="headerlink" title="APP增加多国语言"></a>APP增加多国语言</h2><blockquote>
<p>参考：<a href="https://www.jianshu.com/p/530e033fca33" target="_blank" rel="noopener">让App支持不同的语言</a><br>参考：<a href="https://baike.baidu.com/item/%E8%AF%AD%E8%A8%80%E4%BB%A3%E7%A0%81" target="_blank" rel="noopener">语言代码</a><br>参考：<a href="https://www.cnblogs.com/zyw-205520/p/3848399.html" target="_blank" rel="noopener">Android多语言支持以及各国语言Values文件夹命名规则</a></p>
</blockquote>
<ol>
<li>目录在：<code>res/values-***</code></li>
<li>将各个语言区域的字符串值添加到相应文件中。在运行时，Android 系统会根据当前为用户设备设置的语言区域使用相应的字符串资源集的</li>
<li>如需添加对更多语言的支持，在<code>res/</code>目录下创建名称末尾不同的values，其中目录末尾ISO语言代码则对应着相应语言，譬如：<code>values-fr</code>则代表着手机系统语言为法语时读取的目录</li>
</ol>
<p>例如：</p>
<ul>
<li>英语（默认语言区域），<code>/values/strings.xml</code></li>
<li>中文，<code>/values-zh/strings.xml</code></li>
<li>法语，<code>values-fr/strings.xml</code></li>
</ul>
<hr>
<h2 id="native-crash分析"><a href="#native-crash分析" class="headerlink" title="native crash分析"></a>native crash分析</h2><p>使用addr2line命令定位堆栈地址：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;out&#x2F;target&#x2F;product&#x2F;product&#x2F;symbols&#x2F;system&#x2F;lib64$ addr2line -f -e libgui.so 00000000000c39a0</span><br><span class="line">_ZNK7android12SortedVectorINS_12DisplayStateEE16do_move_backwardEPvPKvm</span><br></pre></td></tr></table></figure>

<p>解释：<code>-e</code>后加上.so的文件名；<code>-f</code>可同时输出函数名称</p>
<p>分析工具：</p>
<ul>
<li>addr2line：<code>addr2line –e obj/local/armeabi/libhello-jni.so 00004de8</code>, 用来分析单个pc地址对应的源码行数</li>
<li>objdump：<code>objdump –S obj/local/armeabi/libhello-jni.so &gt; hello.asm</code>,或者<code>symbols/out/target/product/merlin/symbols$ objdump -tT system/lib64/libdisplayfeature.so</code> 用来把相应的so变成汇编语言的asm文件，然后根据地址信息（比如00000000000c39a0）就可以找到更加详细的相关函数信息；</li>
<li>ndk-stack：用来把log信息全部翻译成更加详细的带源码行数信息的log，相当于是在整个crash堆栈信息都执行addr2line命令。</li>
</ul>
<p><code>addr2line -Cef .so address</code></p>
<p>或者：</p>
<ol>
<li>可以使用<code>readelf -a [.so/.bin]</code>解析库地址</li>
<li>根据解析结果查询函数，C++在linux系统编译后会变成类似<code>_ZNK...</code>的修饰名。使用<code>c++filt</code>获取函数的原始名称：</li>
</ol>
<p><code>c++filt [_ZNK...函数修饰名]</code></p>
<hr>
<h2 id="YUV数据查看"><a href="#YUV数据查看" class="headerlink" title="YUV数据查看"></a>YUV数据查看</h2><ol>
<li>从ffmpeg官网：<code>http://ffmpeg.org/download.html</code>下载最新的ffmpeg安装包，然后通过如下命令解压：<br><code>tar jxf ffmpeg-2.5.3.tar.bz2</code></li>
<li>查看YUV：<br><code>ffplay -f rawvideo -video_size 1280x800 raw_1280x800_1878.yuv</code></li>
</ol>
<p>或者使用YUVPlayer工具，执行：</p>
<p><code>wine yuvplayer.exe</code></p>
<p><strong>YUV Player工具获取：</strong></p>
<ul>
<li><a href="https://github.com/Yonsm/RawPlayer" target="_blank" rel="noopener">https://github.com/Yonsm/RawPlayer</a> RawPlayer</li>
<li><a href="https://github.com/latelee/YUVPlayer" target="_blank" rel="noopener">https://github.com/latelee/YUVPlayer</a> YUVPlayer</li>
<li><a href="https://github.com/figgis/yuv-viewer" target="_blank" rel="noopener">https://github.com/figgis/yuv-viewer</a>  yuv-viewer</li>
<li><a href="https://github.com/Luomingbear/YuvPlayer" target="_blank" rel="noopener">https://github.com/Luomingbear/YuvPlayer</a> android yuv播放器 SDL</li>
</ul>
<hr>
<h2 id="关闭硬件加速"><a href="#关闭硬件加速" class="headerlink" title="关闭硬件加速"></a>关闭硬件加速</h2><p>三种不同针对对象的方法：</p>
<ol>
<li>在AndroidManifest.xml中设置<code>android:hardwareAccelerated=&quot;false&quot;</code>，注意关闭整个app的硬件加速，慎用</li>
<li>View有个方法支持单独的View关闭硬件加速，可以设置<code>mView.setLaterType(View.LAYER_TYPE_SOFTWARE);</code></li>
<li>关闭某一个控件的硬件加速功能：<code>findViewById(R.id.btn).setLayerType(View.LAYER_TYPE_SOFTWARE,null);</code></li>
</ol>
<hr>
<h2 id="linux绘图UML-序列图工具dia"><a href="#linux绘图UML-序列图工具dia" class="headerlink" title="linux绘图UML/序列图工具dia"></a>linux绘图UML/序列图工具dia</h2><ol>
<li>安装：<code>sudo apt-get install dia</code></li>
<li>使用，终端执行：<code>dia</code></li>
</ol>
<hr>
<h2 id="屏幕旋转-转向切换命令"><a href="#屏幕旋转-转向切换命令" class="headerlink" title="屏幕旋转/转向切换命令"></a>屏幕旋转/转向切换命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">adb root</span><br><span class="line">#turn off the automatic rotation</span><br><span class="line">adb shell settings put system accelerometer_rotation 0</span><br><span class="line"># rotate landscape</span><br><span class="line">adb shell settings put system user_rotation 1</span><br><span class="line"># rotate portrait</span><br><span class="line">adb shell settings put system user_rotation 0</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Surface两种合成方式（dump-sf）"><a href="#Surface两种合成方式（dump-sf）" class="headerlink" title="Surface两种合成方式（dump sf）"></a>Surface两种合成方式（dump sf）</h2><ul>
<li><p>Client合成：Client合成方式是相对于硬件合成来说的，其合成方式是，将各个Layer的内容用GPU渲染到暂存缓冲区中，最后将暂存缓冲区传送到显示硬件。这个暂存缓冲区，我们称为FBTarget，每个Display设备有各自的FBTarget。Client合成，之前称为GLES合成，我们也可以称之为GPU合成。Client合成，采用RenderEngine进行合成</p>
</li>
<li><p>Device合成：就是用专门的硬件合成器进行合成HWComposer，所以硬件合成的能力就取决于硬件的实现。其合成方式是将各个Layer的数据全部传给显示硬件，并告知它从不同的缓冲区读取屏幕不同部分的数据。HWComposer是Devicehec的抽象。</p>
</li>
</ul>
<hr>
<h2 id="getprop查看当前版本是user-userdebug"><a href="#getprop查看当前版本是user-userdebug" class="headerlink" title="getprop查看当前版本是user/userdebug"></a>getprop查看当前版本是user/userdebug</h2><p><code>adb shell getprop ro.system.build.type</code></p>
<h2 id="getprop查看设备信息"><a href="#getprop查看设备信息" class="headerlink" title="getprop查看设备信息"></a>getprop查看设备信息</h2><p><code>adb shell getprop ro.build.product</code></p>
<hr>
<h2 id="滑动到边缘Pixel值调试"><a href="#滑动到边缘Pixel值调试" class="headerlink" title="滑动到边缘Pixel值调试"></a>滑动到边缘Pixel值调试</h2><p>AOSP源码位置：<code>/frameworks/base/core/java/com/android/internal/widget/PointerLocationView.java</code>的onDraw函数中有<code>ps.mCoords.x</code>和<code>ps.mCoords.y</code>（float类型），可以将其打印出来，如果有问题可以修改此处转换逻辑</p>
<hr>
<h2 id="Input调试（PointerLocation）"><a href="#Input调试（PointerLocation）" class="headerlink" title="Input调试（PointerLocation）"></a>Input调试（PointerLocation）</h2><h3 id="systrace查看"><a href="#systrace查看" class="headerlink" title="systrace查看"></a>systrace查看</h3><p>systrace可以查看到touch点击的事件</p>
<h3 id="点击input事件-up-down"><a href="#点击input事件-up-down" class="headerlink" title="点击input事件(up/down)"></a>点击input事件(up/down)</h3><p><code>adb shell getevent -lrt</code></p>
<p>查看帮助：<br><code>adb shell getevent -h</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[    1423.973137] &#x2F;dev&#x2F;input&#x2F;event2: EV_ABS       ABS_MT_TRACKING_ID   0000003b            </span><br><span class="line">[    1423.973137] &#x2F;dev&#x2F;input&#x2F;event2: EV_ABS       ABS_MT_POSITION_X    0000017e            &#x2F;&#x2F;十六进制转成十进制 1*16*16+7*16+14*1&#x3D;382   横坐标X</span><br><span class="line">[    1423.973137] &#x2F;dev&#x2F;input&#x2F;event2: EV_ABS       ABS_MT_POSITION_Y    0000032d            &#x2F;&#x2F;3*16*16+2*16+13*1&#x3D;813  纵坐标Y</span><br><span class="line">[    1423.973137] &#x2F;dev&#x2F;input&#x2F;event2: EV_ABS       ABS_MT_TOUCH_MAJOR   0000000a            </span><br><span class="line">[    1423.973137] &#x2F;dev&#x2F;input&#x2F;event2: EV_ABS       ABS_MT_PRESSURE      000003e8            </span><br><span class="line">[    1423.973137] &#x2F;dev&#x2F;input&#x2F;event2: EV_KEY       BTN_TOUCH            DOWN                </span><br><span class="line">[    1423.973137] &#x2F;dev&#x2F;input&#x2F;event2: EV_SYN       SYN_REPORT           00000000            </span><br><span class="line">[    1436.084174] &#x2F;dev&#x2F;input&#x2F;event2: EV_ABS       ABS_MT_TOUCH_MAJOR   00000000            </span><br><span class="line">[    1436.084174] &#x2F;dev&#x2F;input&#x2F;event2: EV_ABS       ABS_MT_PRESSURE      00000000            </span><br><span class="line">[    1436.084174] &#x2F;dev&#x2F;input&#x2F;event2: EV_ABS       ABS_MT_TRACKING_ID   ffffffff            </span><br><span class="line">[    1436.084174] &#x2F;dev&#x2F;input&#x2F;event2: EV_KEY       BTN_TOUCH            UP                  </span><br><span class="line">[    1436.084174] &#x2F;dev&#x2F;input&#x2F;event2: EV_SYN       SYN_REPORT           00000000             rate 0</span><br></pre></td></tr></table></figure>

<h3 id="input和wms的debug-log开关打开"><a href="#input和wms的debug-log开关打开" class="headerlink" title="input和wms的debug log开关打开"></a>input和wms的debug log开关打开</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">adb root</span><br><span class="line">&#x2F;&#x2F;wns debug</span><br><span class="line">adb shell dumpsys window -d enable DEBUG_FOCUS</span><br><span class="line">adb shell dumpsys window -d enable DEBUG_INPUT</span><br><span class="line">&#x2F;&#x2F;或者</span><br><span class="line">adb shell dumpsys window -d enable a</span><br><span class="line">&#x2F;&#x2F;input debug</span><br><span class="line">adb shell setprop sys.inputlog.enabled true</span><br><span class="line">adb shell setprop sys.input.TouchFilterEnable true</span><br><span class="line">adb shell setprop sys.input.TouchFilterLogEnable true</span><br><span class="line">adb shell dumpsys input</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="FPS帧率测试"><a href="#FPS帧率测试" class="headerlink" title="FPS帧率测试"></a>FPS帧率测试</h2><p>查看设备的帧率：<code>while true;do adb shell dumpsys SurfaceFlinger | grep &quot;refresh-rate&quot;;done</code></p>
<h3 id="获取实时帧率（主要用于获取游戏-视频应用的fps数据）"><a href="#获取实时帧率（主要用于获取游戏-视频应用的fps数据）" class="headerlink" title="获取实时帧率（主要用于获取游戏/视频应用的fps数据）"></a>获取实时帧率（主要用于获取游戏/视频应用的fps数据）</h3><blockquote>
<p>参考前面的文章：<a href="https://wizzie.top/Blog/2020/03/31/2020/200330_android_getFPS/" target="_blank" rel="noopener">Android 两种实时获取FPS的方法</a></p>
</blockquote>
<ol>
<li>查询当前的layer（直接dump sf）：<code>adb shell dumpsys SurfaceFlinger --list</code></li>
<li><code>adb shell dumpsys SurfaceFlinger --latency SurfaceView</code></li>
</ol>
<h3 id="dump-gfxinfo信息"><a href="#dump-gfxinfo信息" class="headerlink" title="dump gfxinfo信息"></a>dump gfxinfo信息</h3><blockquote>
<p><code>adb shell dumpsys gfxinfo &lt;package_name&gt;</code></p>
</blockquote>
<p>查看每一帧的信息：<code>adb shell dumpsys gfxinfo &lt;package_name&gt; framestats</code></p>
<p><strong>结果：</strong></p>
<ul>
<li>Graphics info for pid 31148 [com.android.settings]: 表明当前dump的为设置界面的帧信息，pid为31148</li>
<li>Total frames rendered: 105 本次dump搜集了105帧的信息</li>
<li>Janky frames: 2 (1.90%) 105帧中有2帧的耗时超过了16ms，卡顿概率为1.9%</li>
<li>Number Missed Vsync: 0 垂直同步失败的帧</li>
<li>Number High input latency: 0 处理input时间超时的帧数</li>
<li>Number Slow UI thread: 2 因UI线程上的工作导致超时的帧数</li>
<li>Number Slow bitmap uploads: 0 因bitmap的加载耗时的帧数</li>
<li>Number Slow issue draw commands: 1 因绘制导致耗时的帧数</li>
<li>HISTOGRAM: 5ms=78 6ms=16 7ms=4 … 直方图数据</li>
</ul>
<p>例如：<code>while true;do adb shell dumpsys gfxinfo com.android.home framestat;sleep 1;done|tee swipeHome_dumpgfx.log</code></p>
<p>然后通过一秒抓一次，递减总帧数，确认每秒绘制的帧数:</p>
<ul>
<li><p>重置：<code>adb shell dumpsys gfxinfo com.android.home reset</code></p>
</li>
<li><p>抓取：<code>adb shell dumpsys gfxinfo com.android.home framestats</code></p>
</li>
</ul>
<h3 id="查看帧率以及如何在systrace分析帧率"><a href="#查看帧率以及如何在systrace分析帧率" class="headerlink" title="查看帧率以及如何在systrace分析帧率"></a>查看帧率以及如何在systrace分析帧率</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">adb root</span><br><span class="line">adb shell setprop debug.gr.calcfps 1</span><br><span class="line">adb shell setprop debug.gr.calcfps.period 5</span><br><span class="line">adb shell stop</span><br><span class="line">adb shell start</span><br></pre></td></tr></table></figure>

<p>之后可以在logcat中通过<code>fps</code>关键字查看帧率</p>
<p>Tips:</p>
<ol>
<li>该帧率为实时帧率，一个动画的首帧和尾帧存在误差，可以忽略</li>
<li><code>debug.gr.calcfps.period  n</code>:后面的数字n控制统计的帧数</li>
<li>重启手机后将不再统计帧率</li>
</ol>
<h3 id="systrace中的Frame"><a href="#systrace中的Frame" class="headerlink" title="systrace中的Frame"></a>systrace中的Frame</h3><p>在每个app进程，都有一个Frames行，正常情况以绿色的圆点表示。当圆点颜色为黄色或者红色时，意味着这一帧超过16.6ms（即发现丢帧），点击黄色或红色的Frames圆点便会有相关的提示信息；</p>
<p>另外，在systrace的最右侧，有一个<code>Alerts tab</code>可以展开，这里记录着所有的的警告提示信息；</p>
<p>也可以通过放大那一帧进一步分析问题。</p>
<p>对于Android 5.0(API level 21)或者更高的设备，该问题主要聚焦在<code>UI Thread</code>和<code>Render Thread</code>这两个线程当中</p>
<hr>
<h2 id="屏幕录制视频（限定时间长）"><a href="#屏幕录制视频（限定时间长）" class="headerlink" title="屏幕录制视频（限定时间长）"></a>屏幕录制视频（限定时间长）</h2><ul>
<li><code>adb shell screenrecord --time-limit 10 --verbose /sdcard/record.mp4</code></li>
</ul>
<p>录屏带<code>--bugreport</code>调试参数：</p>
<p><code>adb shell screenrecord --bugreport /sdcard/test.mp4</code></p>
<h3 id="截图命令"><a href="#截图命令" class="headerlink" title="截图命令"></a>截图命令</h3><p><code>adb shell screencap /sdcard/screencap.png</code></p>
<hr>
<h2 id="dump-sf查看buffer-layer列表"><a href="#dump-sf查看buffer-layer列表" class="headerlink" title="dump sf查看buffer/layer列表"></a>dump sf查看buffer/layer列表</h2><p><code>adb shell dumpsys SurfaceFlinger --list</code></p>
<h3 id="dump-windows-inpu-sf"><a href="#dump-windows-inpu-sf" class="headerlink" title="dump windows/inpu/sf"></a>dump windows/inpu/sf</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">adb root</span><br><span class="line">adb shell dumpsys input</span><br><span class="line">adb shell dumpsys window -a</span><br><span class="line">adb shell dumpsys SurfaceFlinger</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="源码打开input-debug日志开关"><a href="#源码打开input-debug日志开关" class="headerlink" title="源码打开input debug日志开关"></a>源码打开input debug日志开关</h2><ul>
<li>frameworks/native/services/inputflinger/InputDispatcher.cpp：<code>bool gInputLogEnabled = false;</code>改为true</li>
<li>frameworks/base/services/core/java/com/android/server/policy/PhoneWindowManager.java：<code>static final boolean DEBUG_INPUT = false;</code></li>
</ul>
<hr>
<h2 id="adb打印kernel-log，即内核调试信息dmsg和kmsg"><a href="#adb打印kernel-log，即内核调试信息dmsg和kmsg" class="headerlink" title="adb打印kernel log，即内核调试信息dmsg和kmsg"></a>adb打印kernel log，即内核调试信息dmsg和kmsg</h2><blockquote>
<p>Android的log信息分为内核空间和用户空间中LOG，查看用户空间（也就是app等上层的log）的log直接用<code>adb logcat</code>就可以</p>
<p>如果想过滤一些信息就用<code>adb logcat | grep -E &quot;log_xxx|log_aaa”</code>命令，这样log只会显示含有log_aaa和log_xxx的log信息了。上层的log信息另行查看。</p>
</blockquote>
<ol>
<li><p>执行dmesg命令，可以查看全部消息。如果想把log信息保存到文件，可以用<code>adb shell dmesg &gt; E:/Kernel.log</code>  (输出内核信息)</p>
</li>
<li><p><code>adb shell cat /proc/kmsg</code>：程序里面用printk函数打印的信息会显示出来。</p>
</li>
</ol>
<p>用<code>cat /proc/kmsg</code>命令打印出来的信息跟与dmesg不同。第一次执行<code>/proc/kmsg</code>打印到当前时间的所有内核信息，再次执行<code>cat /proc/kmsg</code>，不会再打印已经打印的信息，只打印上一次执行之后打印出来的新的信息。</p>
<p>Tips:查看kernel log时间，前面是秒，然后隔一段时间会打印<code>android time</code>标记日志</p>
<h3 id="合并kmsg-log"><a href="#合并kmsg-log" class="headerlink" title="合并kmsg log"></a>合并kmsg log</h3><blockquote>
<p><code>adb shell logcat -v time -f /dev/kmsg | adb shell cat /proc/kmsg | tee kernel_logcat.txt</code></p>
</blockquote>
<ul>
<li>“-f”选项 : 该选向后面跟着输入日志的文件, 使用<code>adb logcat -f /sdcard/log.txt</code>命令, 注意这个log文件是输出到手机上，需要指定合适的路径</li>
</ul>
<p>例如触屏inpu事件log抓取：</p>
<p><code>adb shell logcat -v threadtime -f /dev/kmsg | adb shell cat /proc/kmsg | grep -Ei &quot;InputDispatcher|DOWN\!|Up\!|ViewRootImpl|onTouchEvent&quot;</code></p>
<hr>
<h2 id="查看设备的白名单"><a href="#查看设备的白名单" class="headerlink" title="查看设备的白名单"></a>查看设备的白名单</h2><ul>
<li><code>adb shell cat vendor/etc/power_whitelist_cfg.xml</code></li>
</ul>
<p>代码添加示例：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//vendor/PLATFORM/proprietary/hardware/power/config/平台型号/power_whitelist_cfg.xml</span><br><span class="line">        <span class="tag">&lt;<span class="name">Package</span> <span class="attr">name</span>=<span class="string">"com.android.gallery"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Activity</span> <span class="attr">name</span>=<span class="string">"Common"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">PERF_RES_SCHED_BOOST_VALUE_TA</span> <span class="attr">Param1</span>=<span class="string">"10"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">PERF_RES_THERMAL_POLICY</span> <span class="attr">Param1</span>=<span class="string">"8"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">PERF_RES_DRAM_CM_MGR</span> <span class="attr">Param1</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Activity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Package</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Android-mk和Android-bp转换语法"><a href="#Android-mk和Android-bp转换语法" class="headerlink" title="Android.mk和Android.bp转换语法"></a>Android.mk和Android.bp转换语法</h2><p>相互转换的定义在：</p>
<figure class="highlight plain"><figcaption><span>/build/soong/androidmk/cmd/androidmk/android.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;该代码Android Q AOSP，在R之后该文件有变化</span><br><span class="line">func init() &#123;</span><br><span class="line">	addStandardProperties(bpparser.StringType,</span><br><span class="line">		map[string]string&#123;</span><br><span class="line">			&quot;LOCAL_MODULE&quot;:                  &quot;name&quot;,</span><br><span class="line">			&quot;LOCAL_CXX_STL&quot;:                 &quot;stl&quot;,</span><br><span class="line">			&quot;LOCAL_STRIP_MODULE&quot;:            &quot;strip&quot;,</span><br><span class="line">			&quot;LOCAL_MULTILIB&quot;:                &quot;compile_multilib&quot;,</span><br><span class="line">			&quot;LOCAL_ARM_MODE_HACK&quot;:           &quot;instruction_set&quot;,</span><br><span class="line">			&quot;LOCAL_SDK_VERSION&quot;:             &quot;sdk_version&quot;,</span><br><span class="line">			&quot;LOCAL_NDK_STL_VARIANT&quot;:         &quot;stl&quot;,</span><br><span class="line">			&quot;LOCAL_JAR_MANIFEST&quot;:            &quot;manifest&quot;,</span><br><span class="line">			&quot;LOCAL_JARJAR_RULES&quot;:            &quot;jarjar_rules&quot;,</span><br><span class="line">			&quot;LOCAL_CERTIFICATE&quot;:             &quot;certificate&quot;,</span><br><span class="line">			&quot;LOCAL_PACKAGE_NAME&quot;:            &quot;name&quot;,</span><br><span class="line">			&quot;LOCAL_MODULE_RELATIVE_PATH&quot;:    &quot;relative_install_path&quot;,</span><br><span class="line">			&quot;LOCAL_PROTOC_OPTIMIZE_TYPE&quot;:    &quot;proto.type&quot;,</span><br><span class="line">			&quot;LOCAL_MODULE_OWNER&quot;:            &quot;owner&quot;,</span><br><span class="line">			&quot;LOCAL_RENDERSCRIPT_TARGET_API&quot;: &quot;renderscript.target_api&quot;,</span><br><span class="line">			&quot;LOCAL_NOTICE_FILE&quot;:             &quot;notice&quot;,</span><br><span class="line">			&quot;LOCAL_JAVA_LANGUAGE_VERSION&quot;:   &quot;java_version&quot;,</span><br><span class="line">			&quot;LOCAL_INSTRUMENTATION_FOR&quot;:     &quot;instrumentation_for&quot;,</span><br><span class="line">			&quot;LOCAL_MANIFEST_FILE&quot;:           &quot;manifest&quot;,</span><br><span class="line"> </span><br><span class="line">			&quot;LOCAL_DEX_PREOPT_PROFILE_CLASS_LISTING&quot;: &quot;dex_preopt.profile&quot;,</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="将HIDL接口服务从设备system移到vendor"><a href="#将HIDL接口服务从设备system移到vendor" class="headerlink" title="将HIDL接口服务从设备system移到vendor"></a>将HIDL接口服务从设备system移到vendor</h2><ol>
<li>修改Android.bp中添加<code>vendor:true</code>（或者<code>vendor_avaiable：ture</code>）；如果是Android.mk，则添加如下：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LOCAL_MODULE_PATH_64 &#x3D; $(TARGET_OUT_VENDOR)&#x2F;lib64</span><br><span class="line">LOCAL_MODULE_PATH_32 &#x3D; $(TARGET_OUT_VENDOR)&#x2F;lib32</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>如果有<code>.rc</code>文件，则需要修改其中的目录；其中<code>class hal</code>是不会自动启动的，所以需要将其修改成<code>class main</code> ；并且<code>onrestart restart</code>后面添加的是service名称。</li>
</ol>
<p>可以在<code>adb shell；cd /vendor/bin/</code>里面手动执行bin文件，然后查看进程是否启动。</p>
<ol start="3">
<li>在seploicy添加权限：<code>device/PLATFORM/sepolicy/basic/non_plat/file_contexts</code></li>
</ol>
<hr>
<h3 id="Android-bp（可参考）"><a href="#Android-bp（可参考）" class="headerlink" title="Android.bp（可参考）"></a>Android.bp（可参考）</h3><blockquote>
<p><a href="https://source.android.google.cn/devices/architecture/vndk/build-system" target="_blank" rel="noopener">VNDK 构建系统支持</a></p>
</blockquote>
<p>系统将通过以下规则确定cc_library或cc_library_shared的默认安装路径：</p>
<p>将核心变体安装到/system/lib[64]中</p>
<p>供应商变体安装路径可能会有所不同：</p>
<ul>
<li><p>如果<code>vndk.enabled</code>为false，则将供应商变体将安装到<code>/vendor/lib[64]</code>中</p>
</li>
<li><p>如果<code>vndk.enabled</code>为true，则<code>vndk.support_system_process</code>可以是true或false。如果：</p>
</li>
<li><ul>
<li>为false，则供应商变体将安装到<code>/system/lib[64]/vndk-${VER}</code>中</li>
</ul>
</li>
<li><ul>
<li>为true，则供应商变体将安装到<code>/system/lib[64]/vndk-sp-${VER}</code>中</li>
</ul>
</li>
</ul>
<hr>
<h2 id="C函数memset-…"><a href="#C函数memset-…" class="headerlink" title="C函数memset(…)"></a>C函数memset(…)</h2><blockquote>
<p>函数解释：将s中当前位置后面的n个字节<code>（typedef unsigned int size_t ）</code>用ch替换并返回s</p>
</blockquote>
<ul>
<li>memset：作用是在一段内存块中填充某个给定的值，它是对较大的结构体或数组进行清零操作的一种最快方法</li>
<li>memset()函数原型：是<code>extern void *memset(void *buffer, int c, int count)</code>，buffer为指针或是数组，c是赋给buffer的值，count是buffer的长度</li>
</ul>
<hr>
<h2 id="domain-te错误类型"><a href="#domain-te错误类型" class="headerlink" title="domain.te错误类型"></a>domain.te错误类型</h2><blockquote>
<p>错误日志：<code>The following types on /vendor/ must be associated with the &quot;vendor_file_type&quot; attribute: ×××_exec</code></p>
</blockquote>
<ul>
<li>如果是system/则<code>type ***_exec, exec_type, system_file_type, file_type;</code></li>
<li>如果是svendor/则<code>type ***_exec, exec_type, vendor_file_type, file_type;</code></li>
</ul>
<h2 id="查看手机硬件设备（包含屏幕信息）"><a href="#查看手机硬件设备（包含屏幕信息）" class="headerlink" title="查看手机硬件设备（包含屏幕信息）"></a>查看手机硬件设备（包含屏幕信息）</h2><ul>
<li><code>adb shell cat proc/cmdline</code></li>
</ul>
<h2 id="ubuntu的ll命令不能使用"><a href="#ubuntu的ll命令不能使用" class="headerlink" title="ubuntu的ll命令不能使用"></a>ubuntu的<code>ll</code>命令不能使用</h2><p>将<code>ll</code>作为一个别名：</p>
<figure class="highlight plain"><figcaption><span>.bash_profile</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">+ alias ll&#x3D;&#39;ls -alF&#39;&#39;</span><br></pre></td></tr></table></figure>

<p>然后执行<code>source .bash_profile</code>生效</p>
<h2 id="ubuntu挂载硬盘"><a href="#ubuntu挂载硬盘" class="headerlink" title="ubuntu挂载硬盘"></a>ubuntu挂载硬盘</h2><ol>
<li>查看硬盘：<code>sudo fdisk -l</code></li>
</ol>
<p>比如打印：<code>Disk /dev/sdb: 3000.6 GB, 3000592982016 bytes</code></p>
<ol start="2">
<li>编辑添加到文件：<code>sudo vim /etc/fstab</code></li>
</ol>
<p>比如打印：<code>/dev/sdb /sunwg/ ext4 defaults 0 0 (后面的目录是挂载的目录)</code></p>
<ol start="3">
<li>重启电脑，然后<code>df -h</code>查看系统分区</li>
</ol>
<h2 id="find命令"><a href="#find命令" class="headerlink" title="find命令"></a>find命令</h2><p><code>find ./ -iname &quot;*gpuinfo*&quot;</code></p>
<hr>
<p>##　查看CPU/GPU硬件频率</p>
<ul>
<li>查看CPU: <code>adb shell &quot;cat /proc/cpufreq/*/cpufreq_freq&quot;</code></li>
<li>查看DDR: <code>adb shell &quot;cat /sys/devices/platform/10012000.dvfsrc/helio-dvfsrc/dvfsrc_dump | grep -e uv -e khz -e CONTROL -e VCORE_OPP -e DDR_OPP -e LEVEL -e RSV_9&quot;</code></li>
<li>查看GPU频率： <code>adb shell cat /proc/gpufreq/gpufreq_var_dump</code>或者<code>adb shell cat /proc/gpufreq/gpufreq_opp_dump</code></li>
</ul>
<h3 id="设置GPU频率"><a href="#设置GPU频率" class="headerlink" title="设置GPU频率"></a>设置GPU频率</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb root;</span><br><span class="line">adb shell &quot;echo 1000000 &gt; &#x2F;proc&#x2F;gpufreq&#x2F;gpufreq_opp_freq&quot;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="☆CPU-GPU信息文件路径"><a href="#☆CPU-GPU信息文件路径" class="headerlink" title="☆CPU/GPU信息文件路径"></a>☆CPU/GPU信息文件路径</h2><p>CPU信息是在：<code>/sys/devices/system/cpu</code><br>GPU的信息在如下目录查看：<code>/sys/class/kgsl/kgsl-3d0</code></p>
<hr>
<h2 id="加大dequeuebuffer数目"><a href="#加大dequeuebuffer数目" class="headerlink" title="加大dequeuebuffer数目"></a>加大dequeuebuffer数目</h2><p>有时候从systrace中看到dequeuebuffer耗时长，如果可能和gpu/cpu相关，则可以参照上面的方式对gpu/cpu进行提频；</p>
<p>也可以尝试修改文件：<code>/frameworks/native/services/surfaceflinger/BufferQueueLayer.cpp</code></p>
<p><code>mProducer-&gt;setMaxDequeuedBufferCount(1); //增加这里值</code></p>
<p>比如修改为3，看是否有改善</p>
<hr>
<h2 id="windows-cmd过滤log"><a href="#windows-cmd过滤log" class="headerlink" title="windows cmd过滤log"></a>windows cmd过滤log</h2><p><code>adb logcat |find &quot;***&quot;</code></p>
<h2 id="vscode插件"><a href="#vscode插件" class="headerlink" title="vscode插件"></a>vscode插件</h2><p>gitlens：可以查看提交</p>
<hr>
<h2 id="抓取perfetto-trace（替代systrace）"><a href="#抓取perfetto-trace（替代systrace）" class="headerlink" title="抓取perfetto-trace（替代systrace）"></a>抓取perfetto-trace（替代systrace）</h2><ol>
<li>打开<code>开发者选项-&gt;系统跟踪-&gt;显示‘快捷设置’图块</code><br>或者命令方式打开：<code>adb shell am start com.android.traceur/com.android.traceur.MainActivity</code></li>
<li>然后点击“录制跟踪记录”开始抓取</li>
<li>点击停止后分享生成文件，或者命令导出：<code>adb pull data/local/traces</code></li>
<li>使用chrome登录perfetto-trace网站：<code>https://ui.perfetto.dev/#!/</code></li>
</ol>
<p>或者转换成html格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 仅支持python 2.7 且需要GLIBC_2.28版本</span><br><span class="line">curl https:&#x2F;&#x2F;get.perfetto.dev&#x2F;traceconv -o traceconv</span><br><span class="line"></span><br><span class="line">chmod +x traceconv</span><br><span class="line"></span><br><span class="line">.&#x2F;traceconv [text|json|systrace|profile] [input proto file] [output file]</span><br></pre></td></tr></table></figure>

<h3 id="systrace打开空白或者打不开"><a href="#systrace打开空白或者打不开" class="headerlink" title="systrace打开空白或者打不开"></a>systrace打开空白或者打不开</h3><p><strong>在chrome地址栏中输入”chrome:tracing”，然后点击load按钮load你的trace.html文件</strong></p>
<h3 id="atrace转换到html"><a href="#atrace转换到html" class="headerlink" title="atrace转换到html"></a>atrace转换到html</h3><p><code>./systrace.py --from-file 2-1.atrace</code></p>
<p>结果文件生成2-1.html</p>
<h3 id="systrace的类别和选项（直接添加）"><a href="#systrace的类别和选项（直接添加）" class="headerlink" title="systrace的类别和选项（直接添加）"></a>systrace的类别和选项（直接添加）</h3><blockquote>
<p>systrace脚本来源：<code>Android\Sdk\platform-tools\systrace</code></p>
<p>示例命令：<code>./systrace.py -b 8000 -t 5 –list-categories=&quot;Screen turning on&quot; hal app sched gfx view wm power binder_driver -o systrace.html</code></p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">options</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">-o &lt; FILE &gt;</td>
<td align="center">输出的目标文件</td>
</tr>
<tr>
<td align="center">-t N, –time=N</td>
<td align="center">执行时间，默认5s</td>
</tr>
<tr>
<td align="center">-b N, –buf-size=N</td>
<td align="center">buffer大小（单位kB),用于限制trace总大小，默认无上限</td>
</tr>
<tr>
<td align="center">-k &lt; KFUNCS &gt;，–ktrace=&lt; KFUNCS &gt;</td>
<td align="center">追踪kernel函数，用逗号分隔</td>
</tr>
<tr>
<td align="center">-a &lt; APP_NAME &gt;,–app=&lt; APP_NAME &gt;</td>
<td align="center">追踪应用包名，用逗号分隔</td>
</tr>
<tr>
<td align="center">–from-file=&lt; FROM_FILE &gt;</td>
<td align="center">从文件中创建互动的systrace</td>
</tr>
<tr>
<td align="center">-e &lt; DEVICE_SERIAL &gt;,–serial=&lt; DEVICE_SERIAL &gt;</td>
<td align="center">指定设备</td>
</tr>
<tr>
<td align="center">-l, –list-categories</td>
<td align="center">列举可用的tags</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">category</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">gfx</td>
<td align="center">Graphics</td>
</tr>
<tr>
<td align="center">input</td>
<td align="center">Input</td>
</tr>
<tr>
<td align="center">view</td>
<td align="center">View System</td>
</tr>
<tr>
<td align="center">webview</td>
<td align="center">WebView</td>
</tr>
<tr>
<td align="center">wm</td>
<td align="center">Window Manager</td>
</tr>
<tr>
<td align="center">am</td>
<td align="center">Activity Manager</td>
</tr>
<tr>
<td align="center">sm</td>
<td align="center">Sync Manager</td>
</tr>
<tr>
<td align="center">audio</td>
<td align="center">Audio</td>
</tr>
<tr>
<td align="center">video</td>
<td align="center">Video</td>
</tr>
<tr>
<td align="center">camera</td>
<td align="center">Camera</td>
</tr>
<tr>
<td align="center">hal</td>
<td align="center">Hardware Modules</td>
</tr>
<tr>
<td align="center">app</td>
<td align="center">Application</td>
</tr>
<tr>
<td align="center">res</td>
<td align="center">Resource Loading</td>
</tr>
<tr>
<td align="center">dalvik</td>
<td align="center">Dalvik VM</td>
</tr>
<tr>
<td align="center">rs</td>
<td align="center">RenderScript</td>
</tr>
<tr>
<td align="center">bionic</td>
<td align="center">Bionic C Library</td>
</tr>
<tr>
<td align="center">power</td>
<td align="center">Power Management</td>
</tr>
<tr>
<td align="center">sched</td>
<td align="center">CPU Scheduling</td>
</tr>
<tr>
<td align="center">irq</td>
<td align="center">IRQ    Events</td>
</tr>
<tr>
<td align="center">freq</td>
<td align="center">CPU Frequency</td>
</tr>
<tr>
<td align="center">idle</td>
<td align="center">CPU Idle</td>
</tr>
<tr>
<td align="center">disk</td>
<td align="center">Disk I/O</td>
</tr>
<tr>
<td align="center">mmc</td>
<td align="center">eMMC commands</td>
</tr>
<tr>
<td align="center">load</td>
<td align="center">CPU Load</td>
</tr>
<tr>
<td align="center">sync</td>
<td align="center">Synchronization</td>
</tr>
<tr>
<td align="center">workq</td>
<td align="center">Kernel Workqueueszuidi</td>
</tr>
</tbody></table>
<p>几个比较常用的模块：</p>
<ul>
<li>sched：CPU调度的信息，非常重要；你能看到CPU在每个时间段在运行什么线程；线程调度情况，比如锁信息</li>
<li>gfx：Graphic系统的相关信息，包括SurfaceFlinger，VSYNC消息，Texture，RenderThread等；分析卡顿非常依赖这个</li>
<li>view：View绘制系统的相关信息，比如onMeasure，onLayout等；对分析卡顿比较有帮助</li>
<li>am：ActivityManager调用的相关信息；用来分析Activity的启动过程比较有效</li>
<li>dalvik： 虚拟机相关信息，比如GC停顿等</li>
<li>binder_driver：Binder驱动的相关信息，如果你怀疑是Binder IPC的问题，不妨打开这个</li>
<li>core_services：SystemServer中系统核心Service的相关信息，分析特定问题用</li>
</ul>
<hr>
<h2 id="SElinux权限相关"><a href="#SElinux权限相关" class="headerlink" title="SElinux权限相关"></a>SElinux权限相关</h2><blockquote>
<p>参考网站<a href="https://www.pianshen.com/article/6549296922/" target="_blank" rel="noopener">程序员大本营selinux</a></p>
</blockquote>
<ul>
<li>scontext表示进程的<code>SContext，u:r:bluetooth:s0</code>，属于bluetooth域；</li>
<li>tcontext表示目标的<code>SContext，u:r:system_data_file:s0</code>，属于system_data_file类型;</li>
<li>tclass表示进程要操作的<code>ObjectClass</code>，dir表示目录；</li>
</ul>
<h3 id="自动生成selinux权限代码"><a href="#自动生成selinux权限代码" class="headerlink" title="自动生成selinux权限代码"></a>自动生成selinux权限代码</h3><ol>
<li><p>过滤<code>avc</code>关键词代码，导入到新文件log.txt</p>
</li>
<li><p>需要安装：<code>policycoreutils</code></p>
</li>
<li><p>执行命令或区域权限的代码：<br><code>cat log.txt  | grep avc | audit2al</code></p>
</li>
<li><p>命令执行后生成权限相关代码，然后进行修改，例如下面：</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; mcd &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">allow mcd sysfs_battery_supply:dir search;</span><br><span class="line">allow mcd sysfs_battery_supply:file &#123; read open &#125;;</span><br><span class="line">allow mcd sysfs_batteryinfo:dir search;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="开启-关闭Selinux权限"><a href="#开启-关闭Selinux权限" class="headerlink" title="开启/关闭Selinux权限"></a>开启/关闭Selinux权限</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb shell setenforce 0 &#x2F;&#x2F;设置成permissive模式，临时关闭selinux</span><br><span class="line">adb shell setenforce 1 &#x2F;&#x2F;设置成enforce模式</span><br></pre></td></tr></table></figure>

<p>重启后失效</p>
<p>使用<code>adb shell getenforce</code>查看当前权限状态。</p>
<p>可能返回结果有三种：</p>
<ul>
<li>Disabled代表SELinux被禁用</li>
<li>Permissive代表仅记录安全警告但不阻止可疑行</li>
<li>Enforcing代表记录警告且阻止可疑行为</li>
</ul>
<hr>
<h2 id="进入fastboot"><a href="#进入fastboot" class="headerlink" title="进入fastboot"></a>进入fastboot</h2><p><code>adb reboot fastboot</code></p>
<p>或者</p>
<p><code>adb reboot bootloader</code></p>
<hr>
<h2 id="LCD屏幕低温残影现象"><a href="#LCD屏幕低温残影现象" class="headerlink" title="LCD屏幕低温残影现象"></a>LCD屏幕低温残影现象</h2><p>LCD屏幕里的像素发光是由液晶偏转来控制的，而液晶这种材料对温度十分敏感，温度越低，液晶翻转的速度也就越慢，屏幕的响应速度也就会越慢。当画面已经刷新到了下一帧时，液晶还未翻转完成，新生成的画面与未消失的画面错位存在，看上去就像重影一样。</p>
<p>而OLED屏幕的像素点是由一个个单独控制的发光二级管所组成的，低温对其响应速度影响不大，所以单独发光的OLED的响应速度要远高于LCD屏幕。所以OLED屏幕的手机在低温下几乎不会出现拖影的问题。</p>
<p>此外，录屏是录取不到拖影的现象，需要拍视频才能看的到。</p>
<hr>
<h2 id="makefile"><a href="#makefile" class="headerlink" title="makefile"></a>makefile</h2><p>makefile中<code>-D*</code>表示：<code>#define *</code></p>
<p>如：<code>-DPOSGP730 等价于 #define POSGP730</code></p>
<hr>
<h2 id="亮度单位nit"><a href="#亮度单位nit" class="headerlink" title="亮度单位nit"></a>亮度单位nit</h2><p><code>nit(尼特),1nit=1坎德拉/平方米[cd/m2]</code></p>
<p>亮度(L)指物体明暗的程度,定义是单位面积的发光强度,是表示眼睛从某一方向所看到物体反射光的强度。</p>
<h3 id="光学单位lux"><a href="#光学单位lux" class="headerlink" title="光学单位lux"></a>光学单位lux</h3><p>0.1Lux是指摄像机的照度</p>
<p>Lux是一个光学单位，指的是每平方米的光照亮，可以理解成对光线强度的反应，在同等光线条件下，LUX越小的摄像机感光度越好。</p>
<table>
<thead>
<tr>
<th align="center">场所/环境</th>
<th align="center">光照度</th>
</tr>
</thead>
<tbody><tr>
<td align="center">晴天</td>
<td align="center">30000～300000 lux</td>
</tr>
<tr>
<td align="center">晴天室内</td>
<td align="center">100～1000 lux</td>
</tr>
<tr>
<td align="center">阴天</td>
<td align="center">3000～10000 lux</td>
</tr>
<tr>
<td align="center">阴暗夜晚</td>
<td align="center">0.003～0.0007 lux</td>
</tr>
<tr>
<td align="center">夜间路灯</td>
<td align="center">0.1 lux</td>
</tr>
</tbody></table>
<hr>
<h2 id="启动activity-关闭activity"><a href="#启动activity-关闭activity" class="headerlink" title="启动activity/关闭activity"></a>启动activity/关闭activity</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;使用Action方式打开系统设置-输入法设置</span><br><span class="line">adb shell am start -a android.settings.INPUT_METHOD_SETTINGS</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F;使用组件名方式启动照相机功能</span><br><span class="line">adb shell am start -n com.android.camera&#x2F;.Camera</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F;打开拨号界面，并传递一个DATA_URI数据给拨号界面</span><br><span class="line">am start -a android.intent.action.CALL -d tel:10086</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;使用ComponentName方式启动一个Service</span><br><span class="line">adb shell am startservice com.some.package.name&#x2F;.YourServiceSubClassName</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;关闭指定包名的应用程序 </span><br><span class="line">adb shell am force-stop com.some.package</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;杀死进程</span><br><span class="line">adb shell am kill com.some.package</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Git命令"><a href="#Git命令" class="headerlink" title="Git命令"></a>Git命令</h2><h3 id="查看代码提交历史（具体到某一行）"><a href="#查看代码提交历史（具体到某一行）" class="headerlink" title="查看代码提交历史（具体到某一行）"></a>查看代码提交历史（具体到某一行）</h3><p><code>git blame SurfaceFlinger.cpp（文件名）</code></p>
<h3 id="提交代码"><a href="#提交代码" class="headerlink" title="提交代码"></a>提交代码</h3><p><code>git push origin HEAD:refs/for/×××Branch</code></p>
<h3 id="提交草稿代码"><a href="#提交草稿代码" class="headerlink" title="提交草稿代码"></a>提交草稿代码</h3><p><code>git push origin HEAD:refs/drafts/×××Branch</code></p>
<h2 id="提交代码、sync代码报错Agent-admitted-failure-to-sign-using-the-key"><a href="#提交代码、sync代码报错Agent-admitted-failure-to-sign-using-the-key" class="headerlink" title="提交代码、sync代码报错Agent admitted failure to sign using the key"></a>提交代码、sync代码报错<code>Agent admitted failure to sign using the key</code></h2><p>执行：<code>ssh-add ~/.ssh/id_rsa</code></p>
<hr>
<h2 id="apt-get报错不能进行正常更新"><a href="#apt-get报错不能进行正常更新" class="headerlink" title="apt-get报错不能进行正常更新"></a>apt-get报错不能进行正常更新</h2><blockquote>
<p>提示错误信息<code>The package lists or status file could not be parsed or opened</code></p>
</blockquote>
<p>解决方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -vf &#x2F;var&#x2F;lib&#x2F;apt&#x2F;lists&#x2F;*</span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>

<h2 id="ubuntu自带截图快捷键"><a href="#ubuntu自带截图快捷键" class="headerlink" title="ubuntu自带截图快捷键"></a>ubuntu自带截图快捷键</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Alt + Print Screen #截取选中的窗口</span><br><span class="line"></span><br><span class="line">Shift + Print Screen #自由选区</span><br><span class="line"></span><br><span class="line">Ctrl + Print Screen  #整个桌面</span><br><span class="line"></span><br><span class="line">Ctrl + Alt + Print Screen #选中的窗口</span><br><span class="line"></span><br><span class="line">Shift + Ctrl + Print Screen #自由选区</span><br></pre></td></tr></table></figure>

<h2 id="gedit乱码"><a href="#gedit乱码" class="headerlink" title="gedit乱码"></a>gedit乱码</h2><p>执行：<code>gconftool-2 --set --type=list --list-type=string /apps/gedit-2/preferences/encodings/auto_detected &quot;[UTF-8,CURRENT,GB18030,BIG5-HKSCS,UTF-16]&quot;</code></p>
<h2 id="跳过开机向导"><a href="#跳过开机向导" class="headerlink" title="跳过开机向导"></a>跳过开机向导</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb shell settings put secure user_setup_complete 1</span><br><span class="line">adb shell settings put global device_provisioned 1</span><br></pre></td></tr></table></figure>

<h2 id="ubuntu快速下载命令"><a href="#ubuntu快速下载命令" class="headerlink" title="ubuntu快速下载命令"></a>ubuntu快速下载命令</h2><p><code>axel -n 20 下载链接</code></p>
<hr>
<h2 id="谷歌GMS服务"><a href="#谷歌GMS服务" class="headerlink" title="谷歌GMS服务"></a>谷歌GMS服务</h2><blockquote>
<p>GMS（Google Mobile Service），即谷歌移动服务，是Google提供的移动设备上的一系列应用服务，比如包含Play Sotre，Gmail，YouTube，Chrome，Google Maps等。<br>如果需要预置GMS应用，需要通过Google认证，比如CTS、GTS等跑测。</p>
</blockquote>
<h3 id="GMS测试注意事项"><a href="#GMS测试注意事项" class="headerlink" title="GMS测试注意事项"></a>GMS测试注意事项</h3><ol>
<li>如果升级应用到最新版本不再复现，则是应用本身的问题，Google在升级过程中已进行修补</li>
<li>如果仍旧复现，则使用对比机器进行对比验证</li>
</ol>
<h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><h4 id="开机向导设置密码后关机再开机黑屏"><a href="#开机向导设置密码后关机再开机黑屏" class="headerlink" title="开机向导设置密码后关机再开机黑屏"></a>开机向导设置密码后关机再开机黑屏</h4><p>修改方式： </p>
<ol>
<li>找到<code>frameworks/base/packages/SystemUI/src/com/android/systemui/Keyguard/KeyguardViewMediator.java</code></li>
<li>找到函数<code>private void doKeyguardLocked(Bundle options)</code></li>
<li>修改<code>if (!lockedOrMissing &amp;&amp; !provisioned &amp;&amp; !antiTheftLocked)</code> —&gt; <code>if(!lockedOrMissing &amp;&amp; shouldWaitForProvisioning() &amp;&amp; !antiTheftLocked)</code></li>
</ol>
<h4 id="Play-Store无法正常连接"><a href="#Play-Store无法正常连接" class="headerlink" title="Play Store无法正常连接"></a>Play Store无法正常连接</h4><blockquote>
<p>无法登陆Google账户，提示与Google服务器通信时出现问题</p>
</blockquote>
<p>如果可以登录Google账户（设置添加Google账户），而不能进入Google Play，可以抓取一份log，搜索关键字<code>CheckinTask</code>，如果出现如下log：</p>
<p><code>E CheckinTask: Checkin failed: https://android.clients.google.com/checkin (request #0): java.io.IOException: Bad Content-Type: text/html; charset=UTF-8</code></p>
<p>就先检查系统以下属性值的设定是否存在“非法”字符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ro.product.model</span><br><span class="line">ro.product.name</span><br><span class="line">ro.product.device</span><br><span class="line">ro.product.board</span><br></pre></td></tr></table></figure>

<h4 id="Play-Store下载应用失败"><a href="#Play-Store下载应用失败" class="headerlink" title="Play Store下载应用失败"></a>Play Store下载应用失败</h4><blockquote>
<p>从服务器检索信息时出错 (Error retrieving information from server)</p>
</blockquote>
<blockquote>
<p>可以参考：<a href="https://www.uso.cn/post/view/47110" target="_blank" rel="noopener">Google Play商店的各种报错解释以及修复方法</a></p>
</blockquote>
<h4 id="GMS应用首次登陆闪退，第二次正常"><a href="#GMS应用首次登陆闪退，第二次正常" class="headerlink" title="GMS应用首次登陆闪退，第二次正常"></a>GMS应用首次登陆闪退，第二次正常</h4><blockquote>
<p>闪退问题先Check log中是否收到<code>PACKAGE_CHANGED的</code>广播</p>
</blockquote>
<blockquote>
<p>查看<code>system log</code>，Google Maps如果有发生package changed，这是厂商的Maps版本比较旧，开机后联网情况下会自动从server升级造成<code>process kill</code>，属于正常的行为。关键log如下：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">V ActivityManager: Broadcast: Intent &#123; act&#x3D;android.intent.action.PACKAGE_CHANGED dat&#x3D;package:com.google.android.apps.maps flg&#x3D;0x4000010 (has extras) &#125; ordered&#x3D;false userid&#x3D;0 callerApp&#x3D;null</span><br><span class="line">I ActivityManager: Force stopping com.google.android.apps.maps appid&#x3D;10060 user&#x3D;0: pkg changed</span><br><span class="line">I ActivityManager: Killing 6004:com.google.android.apps.maps&#x2F;u0a60 (adj 0): stop com.google.android.apps.maps</span><br></pre></td></tr></table></figure>

<h4 id="GMS应用缺少部分菜单"><a href="#GMS应用缺少部分菜单" class="headerlink" title="GMS应用缺少部分菜单"></a>GMS应用缺少部分菜单</h4><p>如果系统分区太小，会拿掉一些feature，你可以尝试更大的RAM size，比如1GB或更大。</p>
<h4 id="GMS部分应用联网后消失"><a href="#GMS部分应用联网后消失" class="headerlink" title="GMS部分应用联网后消失"></a>GMS部分应用联网后消失</h4><p>GMS中部分应用有地域使用限制，Play Books, Play Magazine, Play Movies等应用目前不支持在中国大陆这边使用，所以联网后应用会自己屏蔽掉，此为正常现象。</p>

                    </article>
                    
    <blockquote class="post-license">
        <p>
            <strong>本文作者&nbsp;:&nbsp;sunwengang</strong>
            <br>
            <strong>
            
                本文使用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)</a> 协议
            </strong>
            <br>
            <strong>本文链接&nbsp;:&nbsp;</strong><a href="https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/">https://alonealive.github.io/Blog/2021/06/07/2021/210607_android_debug3/</a>
        </p>
    </blockquote>



    <blockquote id="date-expire-notification" class="post-expired-notify">本文最后更新于 <span id="date-expire-num"></span> 天前，文中所描述的信息可能已发生改变</blockquote>
    <script>
    (function() {
        var dateUpdate = Date.parse("2021-06-08");
        var nowDate = new Date();
        var a = nowDate.getTime();
        var b = a - dateUpdate;
        var daysUpdateExpire = Math.floor(b/(24*3600*1000));
        if (daysUpdateExpire >= 120) {
            document.getElementById('date-expire-num').innerHTML = daysUpdateExpire;
        } else {
            document.getElementById('date-expire-notification').style.display = 'none';
        }
    })();
    </script>


<p class="post-footer-info mb-0 pt-0">本文发表于&nbsp;<time datetime="2021-06-07T13:52:00.000Z" itemprop="datePublished">2021-06-07</time>

    , 最后修改于&nbsp;<time datetime="2021-06-08T14:50:41.463Z" itemprop="dateModified">2021-06-08</time>

</p>
<p class="post-footer-info mb-0 pt-2">

<span class="post-categories-list mt-2">

<a class="post-categories-list-item" href='/Blog/categories/android/'>android</a>

</span>



<span class="post-tags-list mt-2">

<a class="post-tags-list-item" href="/Blog/tags/android/" rel="tag">#&nbsp;android</a>

<a class="post-tags-list-item" href="/Blog/tags/graphics/" rel="tag">#&nbsp;graphics</a>

<a class="post-tags-list-item" href="/Blog/tags/display/" rel="tag">#&nbsp;display</a>

</span>


</p>

                </div>
                <div class="post-nav px-2 bg-gray">
<ul class="pagination">
    <!-- Prev Nav -->
    
        <li class="page-item page-prev">
            <a href="/Blog/2059/01/01/2021/590101_android_display_graphics/" rel="prev">
                <div class="page-item-title"><i class="icon icon-back" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">Android Display/Graphics自绘UML图[置顶]</div>
            </a>
        </li>
    

    <!-- Next Nav -->
    
        <li class="page-item page-next">
            <a href="/Blog/2021/05/28/2021/210528_cpp_DataStructure4/" rel="next">
                <div class="page-item-title"><i class="icon icon-forward" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">数据结构之二叉树</div>
            </a>
        </li>
    
</ul>
</div>

                
                    <!-- # Comment # -->
                    
                        <div class="card-footer post-comment">
                            <div id="vcomments"></div>

<script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
<script>
    var GUEST_INFO = ['nick','mail','link'];
    var guest_info = 'nick,mail,link'.split(',').filter(function(item){
        return GUEST_INFO.indexOf(item) > -1
    });
    var notify = '' === 'true';
    var verify = '' === 'true';
    new Valine({
        el: '#vcomments',
        notify: notify,
        verify: verify,
        appId: "vhY87VAxwU991O4b7vDREoC7-gzGzoHsz",
        appKey: "CftrDkclI3ylGGjiQeD8C2xz",
        placeholder: "Just go go",
        meta: guest_info,
        pageSize:'10',
        avatar:'identicon',
        lang:'zh-cn',
        guest_info: guest_info,
        visitor: false
    });
</script>

                        </div>
                    
                
            </div>
        </div>
    </div>
</div>

            <!-- ### Footer ### -->
            <footer class="text-center">
    <!-- footer copyright -->
    
        <p class="footer-copyright mb-0">Copyright&nbsp;©&nbsp;<span id="copyright-year"></span>
            <a class="footer-copyright-a" href="https://alonealive.github.io/Blog">sunwengang blog</a>
        </p>

    <!-- footer custom text -->
    <p class="footer-text mb-0">
    
    </p>
    <!-- footer develop info -->
    <p class="footer-develop mb-0">
        
    <!-- Busuanzi User Views -->
    <span id="busuanzi_container_site_uv" hidden>
        <span></span>
        <span id="busuanzi_value_site_uv"></span>
        <span>Viewers</span>
        
            <span>|</span>
        
    </span>




        
        Powered by&nbsp;<!--
         --><a href="https://hexo.io" target="_blank" class="footer-develop-a" rel="external nofollow noopener noreferrer">Hexo</a><span class="footer-develop-divider"></span>Theme&nbsp;-&nbsp;<!--
         --><a href="https://github.com/SukkaW/hexo-theme-suka" target="_blank" class="footer-develop-a" rel="external noopener">Suka</a>
    </p>
</footer>


        <!-- ### Import File ### -->
        <!-- ### Footer JS Import ### -->

<script>

    
window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 50
};

(function() {
    var copyrightNow = new Date().getFullYear();
    var copyrightContent = document.getElementById('copyright-year');
    var copyrightSince = 2019;
    if (copyrightSince === copyrightNow) {
        copyrightContent.textContent = copyrightNow;
    } else {
        copyrightContent.textContent = copyrightSince + ' - ' + copyrightNow;
    }
})();
console.log('\n %c Suka Theme (hexo-theme-suka) | © SukkaW | Verision 1.3.3 %c https://github.com/SukkaW/hexo-theme-suka \n', 'color: #fff; background: #444; padding:5px 0;', 'background: #bbb; padding:5px 0;');

</script>

<script src="/Blog/lib/vanilla-lazyload/lazyload.min.js" async></script>
    <script src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" async></script>


<!-- Offset -->




<!-- Comment -->

    
        
    


<!-- ### Custom Footer ### -->

    </body>

</html>